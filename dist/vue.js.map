{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/compiler/parse.js","../src/compiler/codegen.js","../src/compiler/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/util/next-tick.js","../src/render.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n    return typeof val === 'function'\r\n}\r\n\r\nexport function isObject(val) {\r\n    return typeof val === 'object' && val !== null\r\n}","// arrayMethodsæ˜¯ç»§æ‰¿è‡ªArray.prototypeï¼Œä¸ç›´æ¥ä¿®æ”¹Array.prototypeï¼Œä¸æ±¡æŸ“Array.prototype\r\nlet oldArrayPrototype = Array.prototype\r\nexport let arrayMethods = Object.create(oldArrayPrototype)\r\n\r\nlet methods = [\r\n    'push',\r\n    'pop',\r\n    'unshift',\r\n    'shift',\r\n    'sort',\r\n    'reverse',\r\n    'splice'\r\n]\r\n\r\nmethods.forEach(method => {\r\n    arrayMethods[method] = function(...args) {\r\n        const result = oldArrayPrototype[method].call(this,...args) // thisæŒ‡å‘è°ƒç”¨è¯¥æ–¹æ³•çš„dataï¼ˆå³ç»è¿‡å“åº”å¼å¤„ç†çš„æ•°ç»„ï¼‰\r\n\r\n        // å¯¹äºæ•°ç»„ä¸­æ–°å¢çš„å…ƒç´ ï¼Œä¹Ÿéœ€è¦è¿›è¡Œç›‘æ§\r\n        const ob = this.__ob__;\r\n        let inserted;\r\n        switch (method) {\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;\r\n                break;\r\n            case \"splice\":\r\n                inserted = args.slice(2);\r\n            default:\r\n                break;\r\n        }\r\n        // insertedæ˜¯ä¸ªæ•°ç»„ï¼Œéœ€è¦è°ƒç”¨observeArrayæ¥ç›‘æµ‹\r\n        if (inserted) ob.observeArray(inserted);\r\n        return result\r\n    }\r\n})","import { isObject } from \"../utils\";\r\nimport { arrayMethods } from \"./array\";\r\n\r\n/**\r\n * æ•°æ®åŠ«æŒï¼š\r\n * 1. å¦‚æœæ˜¯å¯¹è±¡ï¼Œåˆ™é€’å½’å¯¹è±¡æ‰€æœ‰å±æ€§ï¼Œè¿›è¡ŒåŠ«æŒ\r\n * 2. å¦‚æœæ•°ç»„ï¼Œåˆ™ä¼šåŠ«æŒæ•°ç»„æ–¹æ³•ï¼ˆæ–¹æ³•ä¸­å¦‚æœæ˜¯æ–°å¢å…ƒç´ ï¼Œä¼šåŠ«æŒæ–°å¢å…ƒç´ ï¼‰ï¼Œå¹¶å¯¹æ•°ç»„ä¸­ç±»å‹ä¸ºæ•°ç»„/å¯¹è±¡çš„å…ƒç´ è¿›è¡ŒåŠ«æŒ\r\n */\r\n\r\nclass Observer {\r\n  // é€šè¿‡newå‘½ä»¤ç”Ÿæˆclasså®ä¾‹æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨constructor()ï¼Œå³ä¼šæ‰§è¡Œthis.walk(data)æ–¹æ³•\r\n  constructor(data) {\r\n    // åœ¨æ•°æ®dataä¸Šæ–°å¢å±æ€§ data.__ob__ï¼›æŒ‡å‘ç»è¿‡new Observer(data)åˆ›å»ºçš„å®ä¾‹ï¼Œå¯ä»¥è®¿é—®Observer.prototypeä¸Šçš„æ–¹æ³•observeArrayã€walkç­‰\r\n    // æ‰€æœ‰è¢«åŠ«æŒè¿‡çš„æ•°æ®éƒ½æœ‰__ob__å±æ€§ï¼ˆé€šè¿‡è¿™ä¸ªå±æ€§å¯ä»¥åˆ¤æ–­æ•°æ®æ˜¯å¦è¢«æ£€æµ‹è¿‡ï¼‰\r\n    Object.defineProperty(data, \"__ob__\", {\r\n      //  å€¼æŒ‡ä»£çš„å°±æ˜¯Observerçš„å®ä¾‹\r\n      value: this,\r\n      //  è®¾ä¸ºä¸å¯æšä¸¾ï¼Œé˜²æ­¢åœ¨forEachå¯¹æ¯ä¸€é¡¹å“åº”å¼çš„æ—¶å€™ç›‘æ§__ob__ï¼Œé€ æˆæ­»å¾ªç¯\r\n      enumerable: false,\r\n      writable: true,\r\n      configurable: true,\r\n    });\r\n\r\n    /**\r\n     * æ€è€ƒä¸€ä¸‹æ•°ç»„å¦‚ä½•è¿›è¡Œå“åº”å¼ï¼Ÿ\r\n     * å’Œå¯¹è±¡ä¸€æ ·ï¼Œå¯¹æ¯ä¸€ä¸ªå±æ€§è¿›è¡Œä»£ç†å—ï¼Ÿ\r\n     * å¦‚æœæ•°ç»„é•¿åº¦ä¸º10000ï¼Œç»™æ¯ä¸€é¡¹è®¾ç½®ä»£ç†ï¼Œæ€§èƒ½éå¸¸å·®ï¼\r\n     * ç”¨æˆ·å¾ˆå°‘é€šè¿‡ç´¢å¼•æ“ä½œæ•°ç»„ï¼Œæˆ‘ä»¬åªéœ€è¦é‡å†™æ•°ç»„çš„åŸå‹æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­è¿›è¡Œå“åº”å¼å³å¯ã€‚\r\n     */\r\n    if (Array.isArray(data)) {\r\n      // æ•°ç»„å“åº”å¼å¤„ç†\r\n\r\n      // é‡å†™æ•°ç»„çš„åŸå‹æ–¹æ³•ï¼Œå°†dataåŸå‹æŒ‡å‘é‡å†™åçš„å¯¹è±¡\r\n      data.__proto__ = arrayMethods;\r\n\r\n      // å¦‚æœæ•°ç»„ä¸­çš„æ•°æ®æ˜¯å¯¹è±¡ï¼Œéœ€è¦ç›‘æ§å¯¹è±¡çš„å˜åŒ–\r\n      this.observeArray(data);\r\n    } else {\r\n      // å¯¹è±¡å“åº”å¼å¤„ç†\r\n      this.walk(data);\r\n    }\r\n  }\r\n  observeArray(data) {\r\n    // ã€å…³é”®ã€‘é€’å½’äº†ï¼Œç›‘æ§æ•°ç»„æ¯ä¸€é¡¹ï¼ˆobserveä¼šç­›é€‰å‡ºå¯¹è±¡å’Œæ•°ç»„ï¼Œå…¶ä»–çš„ä¸ç›‘æ§ï¼‰çš„æ”¹å˜ï¼Œæ•°ç»„é•¿åº¦å¾ˆé•¿çš„è¯ï¼Œä¼šå½±å“æ€§èƒ½\r\n    // ã€*********ã€‘æ•°ç»„å¹¶æ²¡æœ‰å¯¹ç´¢å¼•è¿›è¡Œç›‘æ§ï¼Œä½†æ˜¯å¯¹æ•°ç»„çš„åŸå‹æ–¹æ³•è¿›è¡Œäº†æ”¹å†™ï¼Œè¿˜å¯¹æ¯ä¸€é¡¹ï¼ˆæ•°ç»„å’Œå¯¹è±¡ç±»å‹ï¼‰è¿›è¡Œäº†ç›‘æ§\r\n    data.forEach((item) => {\r\n      observe(item);\r\n    });\r\n  }\r\n  walk(data) {\r\n    Object.keys(data).forEach((key) => {\r\n      // å¯¹dataä¸­çš„æ¯ä¸ªå±æ€§è¿›è¡Œå“åº”å¼å¤„ç†\r\n      defineReactive(data, key, data[key]);\r\n    });\r\n  }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n  observe(value); // ã€å…³é”®ã€‘é€’å½’ï¼ŒåŠ«æŒå¯¹è±¡ä¸­æ‰€æœ‰å±‚çº§çš„æ‰€æœ‰å±æ€§\r\n  // å¦‚æœVueæ•°æ®åµŒå¥—å±‚çº§è¿‡æ·± >> æ€§èƒ½ä¼šå—å½±å“ã€******************************ã€‘\r\n\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      // todo...æ”¶é›†ä¾èµ–\r\n      return value;\r\n    },\r\n    set(newVal) {\r\n      // å¯¹æ–°æ•°æ®è¿›è¡Œè§‚å¯Ÿ\r\n      observe(newVal);\r\n      value = newVal;\r\n      // todo...æ›´æ–°è§†å›¾\r\n    },\r\n  });\r\n}\r\n\r\nexport function observe(data) {\r\n  // å¦‚æœæ˜¯objectç±»å‹ï¼ˆå¯¹è±¡æˆ–æ•°ç»„ï¼‰æ‰è§‚æµ‹ï¼›ç¬¬ä¸€æ¬¡è°ƒç”¨observe(vm.$options._data)æ—¶ï¼Œ_dataä¸€å®šæ˜¯ä¸ªå¯¹è±¡ï¼Œå®˜æ–¹è¦æ±‚çš„å†™æ³•ï¼ˆdataå‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼‰\r\n  if (!isObject(data)) {\r\n    return;\r\n  }\r\n  // å¦‚æœå·²ç»æ˜¯å“åº”å¼çš„æ•°æ®ï¼Œç›´æ¥return\r\n  if (data.__ob__) {\r\n    return;\r\n  }\r\n  // è¿”å›ç»è¿‡å“åº”å¼å¤„ç†ä¹‹åçš„data\r\n  return new Observer(data);\r\n}\r\n","/**\r\n * æ•°æ®åˆå§‹åŒ–ï¼šinitPropsã€initMethodã€initDataã€initComputedã€initWatch\r\n */\r\n\r\nimport { observe } from \"./observer/index\";\r\nimport { isFunction } from \"./utils\";\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options;\r\n  if (opts.props) {\r\n    initProps(vm);\r\n  }\r\n  if (opts.methods) {\r\n    initMethod(vm);\r\n  }\r\n  if (opts.data) {\r\n    // åˆå§‹åŒ–data\r\n    initData(vm);\r\n  }\r\n  if (opts.computed) {\r\n    initComputed(vm);\r\n  }\r\n  if (opts.watch) {\r\n    initWatch(vm);\r\n  }\r\n\r\n  function initProps() {}\r\n  function initMethod() {}\r\n  function initData(vm) {\r\n    let data = vm.$options.data;\r\n    // å¾€å®ä¾‹ä¸Šæ·»åŠ ä¸€ä¸ªå±æ€§ _dataï¼Œå³ä¼ å…¥çš„data\r\n    // vueç»„ä»¶dataæ¨èä½¿ç”¨å‡½æ•° é˜²æ­¢æ•°æ®åœ¨ç»„ä»¶ä¹‹é—´å…±äº«\r\n    data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n\r\n    // å°†vm._dataä¸Šçš„æ‰€æœ‰å±æ€§ä»£ç†åˆ° vm ä¸Š\r\n    for (let key in data) {\r\n      proxy(vm, \"_data\", key);\r\n    }\r\n    // å¯¹æ•°æ®è¿›è¡Œè§‚æµ‹ -- æ•°æ®å“åº”å¼\r\n    observe(data);\r\n  }\r\n  function initComputed() {}\r\n  function initWatch() {}\r\n\r\n  // å°†vm._dataä¸Šçš„å±æ€§ä»£ç†åˆ° vm ä¸Š\r\n  function proxy(vm, source, key) {\r\n    Object.defineProperty(vm, key, {\r\n      get() {\r\n        return vm[source][key];\r\n      },\r\n      set(newValue) {\r\n        vm[source][key] = newValue;\r\n      },\r\n    });\r\n  }\r\n}\r\n","// ä»¥ä¸‹ä¸ºvueæºç çš„æ­£åˆ™\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //åŒ¹é…æ ‡ç­¾åï¼›å½¢å¦‚ abc-123\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //åŒ¹é…ç‰¹æ®Šæ ‡ç­¾;å½¢å¦‚ abc:234,å‰é¢çš„abc:å¯æœ‰å¯æ— ï¼›è·å–æ ‡ç­¾åï¼›\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // åŒ¹é…æ ‡ç­¾å¼€å¤´ï¼›å½¢å¦‚  <  ï¼›æ•è·é‡Œé¢çš„æ ‡ç­¾å\r\nconst startTagClose = /^\\s*(\\/?)>/; // åŒ¹é…æ ‡ç­¾ç»“å°¾ï¼Œå½¢å¦‚ >ã€/>\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // åŒ¹é…ç»“æŸæ ‡ç­¾ å¦‚ </abc-123> æ•è·é‡Œé¢çš„æ ‡ç­¾å\r\nconst attribute =\r\n  /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // åŒ¹é…å±æ€§  å½¢å¦‚ id=\"app\"\r\n\r\nexport function parse(template) {\r\n  /**\r\n   * handleStartTagã€handleEndTagã€handleCharså°†åˆå§‹è§£æçš„ç»“æœï¼Œç»„è£…æˆä¸€ä¸ªæ ‘ç»“æ„ã€‚\r\n   * ä½¿ç”¨æ ˆç»“æ„æ„å»ºASTæ ‘\r\n   */\r\n  let root; // æ ¹èŠ‚ç‚¹\r\n  let currentParent; // ä¸‹ä¸€ä¸ªå­å…ƒç´ çš„çˆ¶å…ƒç´ \r\n  let stack = []; // æ ˆç»“æ„ï¼›æ ˆä¸­push/popå…ƒç´ èŠ‚ç‚¹ï¼Œå¯¹äºæ–‡æœ¬èŠ‚ç‚¹ï¼Œç›´æ¥pushåˆ°currentParent.childrenå³å¯ï¼Œä¸ç”¨pushåˆ°æ ˆä¸­\r\n  // è¡¨ç¤ºå…ƒç´ å’Œæ–‡æœ¬çš„type\r\n  const ELEMENT_TYPE = 1;\r\n  const TEXT_TYPE = 3;\r\n  // åˆ›å»ºASTèŠ‚ç‚¹\r\n  function createASTElement(tagName, attrs) {\r\n    return {\r\n      tag: tagName,\r\n      type: ELEMENT_TYPE,\r\n      children: [],\r\n      attrs,\r\n      parent: null,\r\n    };\r\n  }\r\n  // å¯¹å¼€å§‹æ ‡ç­¾è¿›è¡Œå¤„ç†\r\n  function handleStartTag({ tagName, attrs }) {\r\n    let element = createASTElement(tagName, attrs);\r\n    // å¦‚æœæ²¡æœ‰æ ¹å…ƒç´ ï¼Œåˆ™å½“å‰å…ƒç´ å³ä¸ºæ ¹å…ƒç´ \r\n    if (!root) {\r\n      root = element;\r\n    }\r\n    currentParent = element;\r\n    // å°†å…ƒç´ æ”¾å…¥æ ˆä¸­\r\n    stack.push(element);\r\n  }\r\n  // å¯¹ç»“æŸæ ‡ç­¾è¿›è¡Œå¤„ç†\r\n  function handleEndTag(tagName) {\r\n    // å¤„ç†åˆ°ç»“æŸæ ‡ç­¾æ—¶ï¼Œå°†è¯¥å…ƒç´ ä»æ ˆä¸­ç§»å‡º\r\n    let element = stack.pop();\r\n    if (element.tag !== tagName) {\r\n        throw new Error('æ ‡ç­¾åæœ‰è¯¯')\r\n    }\r\n    // currentParentæ­¤æ—¶ä¸ºelementçš„ä¸Šä¸€ä¸ªå…ƒç´ \r\n    currentParent = stack[stack.length - 1];\r\n    // å»ºç«‹parentå’Œchildrenå…³ç³»\r\n    if (currentParent) {\r\n      element.parent = currentParent;\r\n      currentParent.children.push(element);\r\n    }\r\n  }\r\n  // å¯¹æ–‡æœ¬è¿›è¡Œå¤„ç†\r\n  function handleChars(text) {\r\n    // å»æ‰ç©ºæ ¼\r\n    text = text.replace(/\\s/g, \"\");\r\n    if (text) {\r\n      currentParent.children.push({\r\n        type: TEXT_TYPE,\r\n        text,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * é€’å½’è§£ætemplateï¼Œè¿›è¡Œåˆæ­¥å¤„ç†\r\n   * è§£æå¼€å§‹æ ‡ç­¾ï¼Œå°†ç»“æœ{tagName, attrs} äº¤ç»™ handleStartTag å¤„ç†\r\n   * è§£æç»“æŸæ ‡ç­¾ï¼Œå°†ç»“æœ tagName äº¤ç»™ handleEndTag å¤„ç†\r\n   * è§£ææ–‡æœ¬é—¨å°†ç»“æœ text äº¤ç»™ handleChars å¤„ç†\r\n   */\r\n  while (template) {\r\n    // æŸ¥æ‰¾ < çš„ä½ç½®ï¼Œæ ¹æ®å®ƒçš„ä½ç½®åˆ¤æ–­ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä»€ä¹ˆæ ‡ç­¾\r\n    let textEnd = template.indexOf(\"<\");\r\n\r\n    // å½“ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º '<' æ—¶ï¼Œå³ç¢°åˆ°å¼€å§‹æ ‡ç­¾/ç»“æŸæ ‡ç­¾æ—¶\r\n    if (textEnd === 0) {\r\n      // åŒ¹é…å¼€å§‹æ ‡ç­¾<div> æˆ– <image/>\r\n      const startTagMatch = parseStartTag();\r\n      if (startTagMatch) {\r\n        handleStartTag(startTagMatch);\r\n        continue; // continue è¡¨ç¤ºè·³å‡ºæœ¬æ¬¡å¾ªç¯ï¼Œè¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯\r\n      }\r\n\r\n      // åŒ¹é…ç»“æŸæ ‡ç­¾</div>\r\n      const endTagMatch = template.match(endTag);\r\n      if (endTagMatch) {\r\n        // endTagMatchå¦‚æœåŒ¹é…æˆåŠŸï¼Œå…¶æ ¼å¼ä¸ºæ•°ç»„ï¼š['</div>', 'div']\r\n        advance(endTagMatch[0].length);\r\n        handleEndTag(endTagMatch[1]);\r\n        continue;\r\n      }\r\n    }\r\n\r\n    // å½“ç¬¬ä¸€ä¸ªå…ƒç´ ä¸æ˜¯'<'ï¼Œå³ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ–‡æœ¬æ—¶\r\n    let text;\r\n    if (textEnd >= 0) {\r\n      // è·å–æ–‡æœ¬\r\n      text = template.substring(0, textEnd);\r\n    }\r\n    if (text) {\r\n      advance(text.length);\r\n      handleChars(text);\r\n    }\r\n  }\r\n\r\n  // è§£æå¼€å§‹æ ‡ç­¾\r\n  function parseStartTag() {\r\n    // 1. åŒ¹é…å¼€å§‹æ ‡ç­¾\r\n    const start = template.match(startTagOpen);\r\n    // startæ ¼å¼ä¸ºæ•°ç»„ï¼Œå½¢å¦‚ ['<div', 'div']ï¼›ç¬¬äºŒé¡¹ä¸ºæ ‡ç­¾å\r\n    if (start) {\r\n      const match = {\r\n        tagName: start[1],\r\n        attrs: [],\r\n      };\r\n\r\n      //åŒ¹é…åˆ°äº†å¼€å§‹æ ‡ç­¾ï¼Œå°±æŠŠ <tagname æˆªå–æ‰ï¼Œå¾€åç»§ç»­åŒ¹é…å±æ€§\r\n      advance(start[0].length);\r\n\r\n      // 2. å¼€å§‹é€’å½’åŒ¹é…æ ‡ç­¾å±æ€§\r\n      // endä»£è¡¨ç»“æŸç¬¦å· > ï¼›å¦‚æœåŒ¹é…æˆåŠŸï¼Œæ ¼å¼ä¸ºï¼š['>', '']\r\n      // attr è¡¨ç¤ºåŒ¹é…çš„å±æ€§\r\n      let end, attr;\r\n      // ä¸æ˜¯æ ‡ç­¾ç»“å°¾ï¼Œå¹¶ä¸”èƒ½åŒ¹é…åˆ°å±æ€§æ—¶\r\n      while (\r\n        !(end = template.match(startTagClose)) &&\r\n        (attr = template.match(attribute))\r\n      ) {\r\n        // attrå¦‚æœåŒ¹é…æˆåŠŸï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ ¼å¼ä¸ºï¼š[\"class=\\\"myClass\\\"\", \"class\", \"=\", \"myClass\", undefined, undefined]\r\n        // attr[1]ä¸ºå±æ€§åï¼Œattr[3]/attr[4]/attr[5]ä¸ºå±æ€§å€¼ï¼Œå–å†³äºå±æ€§å®šä¹‰æ˜¯åŒå¼•å·/å•å¼•å·/æ— å¼•å·\r\n\r\n        // åŒ¹é…æˆåŠŸä¸€ä¸ªå±æ€§ï¼Œå°±åœ¨templateä¸Šæˆªå–æ‰è¯¥å±æ€§ï¼Œç»§ç»­å¾€ååŒ¹é…\r\n        advance(attr[0].length);\r\n        attr = {\r\n          name: attr[1],\r\n          value: attr[3] || attr[4] || attr[5], //è¿™é‡Œæ˜¯å› ä¸ºæ­£åˆ™æ•è·æ”¯æŒåŒå¼•å·ï¼ˆï¼‰ å•å¼•å· å’Œæ— å¼•å·çš„å±æ€§å€¼\r\n        };\r\n        match.attrs.push(attr);\r\n      }\r\n\r\n      // 3. åŒ¹é…åˆ°å¼€å§‹æ ‡ç­¾ç»“å°¾\r\n      if (end) {\r\n        //   ä»£è¡¨ä¸€ä¸ªæ ‡ç­¾åŒ¹é…åˆ°ç»“æŸçš„>äº† ä»£è¡¨å¼€å§‹æ ‡ç­¾è§£æå®Œæ¯•\r\n        advance(1);\r\n        return match;\r\n      }\r\n    }\r\n  }\r\n\r\n  // æˆªå–templateå­—ç¬¦ä¸² æ¯æ¬¡åŒ¹é…åˆ°äº†å°±ã€å¾€å‰ç»§ç»­åŒ¹é…ã€‘\r\n  function advance(n) {\r\n    template = template.substring(n);\r\n  }\r\n\r\n  // è¿”å›ç”Ÿæˆçš„astï¼›rootåŒ…å«æ•´ä¸ªæ ‘çŠ¶ç»“æ„ä¿¡æ¯\r\n  return root;\r\n}\r\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // åŒ¹é…èŠ±æ‹¬å· {{  }}ï¼›æ•è·èŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹\r\nfunction gen(node) {\r\n  // å¦‚æœæ˜¯å…ƒç´ ç±»å‹\r\n  if (node.type == 1) {\r\n    // ã€å…³é”®ã€‘é€’å½’åˆ›å»º\r\n    return generate(node);\r\n  } else {\r\n    // elseå³æ–‡æœ¬ç±»å‹\r\n    let text = node.text;\r\n\r\n    // 1. å¦‚æœtextä¸­ä¸å­˜åœ¨èŠ±æ‹¬å·å˜é‡è¡¨è¾¾å¼\r\n    if (!defaultTagRE.test(text)) {\r\n      // _vè¡¨ç¤ºåˆ›å»ºæ–‡æœ¬\r\n      return `_v(${JSON.stringify(text)})`;\r\n    }\r\n\r\n    // æ­£åˆ™æ˜¯å…¨å±€æ¨¡å¼ æ¯æ¬¡éœ€è¦é‡ç½®æ­£åˆ™çš„lastIndexå±æ€§ï¼Œä¸ç„¶ä¼šå¼•å‘åŒ¹é…bugï¼ˆdefaultTagRE.exec()åŒ¹é…å®Œä¸€æ¬¡åï¼Œå†æ¬¡åŒ¹é…ä¸ºnullï¼Œéœ€è¦é‡ç½®lastIndexï¼‰\r\n    let lastIndex = (defaultTagRE.lastIndex = 0);\r\n    let tokens = [];\r\n    let match, index;\r\n\r\n    // 2. å¦‚æœtextä¸­å­˜åœ¨èŠ±æ‹¬å·å˜é‡ï¼ˆä½¿ç”¨whileå¾ªç¯ï¼Œæ˜¯å› ä¸ºå¯èƒ½å­˜åœ¨å¤šä¸ª{{å˜é‡}}ï¼‰\r\n    while ((match = defaultTagRE.exec(text))) {\r\n      // matchå¦‚æœåŒ¹é…æˆåŠŸï¼Œå…¶ç»“æ„ä¸ºï¼š['{{myValue}}', 'myValue', index: indexof({) ]\r\n      // indexä»£è¡¨åŒ¹é…åˆ°çš„ä½ç½®\r\n      index = match.index;\r\n      // åˆå§‹ lastIndex ä¸º0ï¼Œindex > lastIndex è¡¨ç¤ºåœ¨{{ å‰æœ‰æ™®é€šæ–‡æœ¬\r\n      if (index > lastIndex) {\r\n        // åœ¨tokensé‡Œé¢æ”¾å…¥ {{ ä¹‹å‰çš„æ™®é€šæ–‡æœ¬\r\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)));\r\n      }\r\n      // tokensä¸­æ”¾å…¥æ•è·åˆ°çš„å˜é‡å†…å®¹\r\n      tokens.push(`_s(${match[1].trim()})`);\r\n      // åŒ¹é…æŒ‡é’ˆåç§»ï¼Œç§»åˆ° }} åé¢\r\n      lastIndex = index + match[0].length;\r\n    }\r\n\r\n    // 3. å¦‚æœåŒ¹é…å®Œäº†èŠ±æ‹¬å·ï¼Œtexté‡Œé¢è¿˜æœ‰å‰©ä½™çš„æ™®é€šæ–‡æœ¬ï¼Œé‚£ä¹ˆç»§ç»­push\r\n    if (lastIndex < text.length) {\r\n      tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n    }\r\n    // _vè¡¨ç¤ºåˆ›å»ºæ–‡æœ¬\r\n    return `_v(${tokens.join(\"+\")})`;\r\n  }\r\n}\r\n\r\n// ç”Ÿæˆå­èŠ‚ç‚¹ï¼šéå†childrenè°ƒç”¨gen(item)ï¼Œä½¿ç”¨é€—å·æ‹¼æ¥æ¯ä¸€é¡¹çš„ç»“æœ\r\nfunction getChildren(el) {\r\n  const children = el.children;\r\n  if (children) {\r\n    return `${children.map((c) => gen(c)).join(\",\")}`;\r\n  }\r\n}\r\n\r\n// å¤„ç†attrs/propså±æ€§ï¼šå°†[{name: 'class', value: 'home'}, {name: 'style', value: \"font-size:12px;color:red\"}]\r\n//                  è½¬åŒ–æˆ \"class:\"home\",style:{\"font-size\":\"12px\",\"color\":\"red\"}\"\r\nfunction genProps(attrs) {\r\n  let str = \"\";\r\n  for (let i = 0; i < attrs.length; i++) {\r\n    let attr = attrs[i];\r\n    // å¯¹attrså±æ€§é‡Œé¢çš„styleåšç‰¹æ®Šå¤„ç†\r\n    if (attr.name === \"style\") {\r\n      let obj = {};\r\n      attr.value.split(\";\").forEach((item) => {\r\n        let [key, value] = item.split(\":\");\r\n        obj[key] = value;\r\n      });\r\n      attr.value = obj;\r\n    }\r\n    str += `${attr.name}:${JSON.stringify(attr.value)},`;\r\n  }\r\n  return `{${str.slice(0, -1)}}`;\r\n}\r\n\r\nexport function generate(ast) {\r\n  let children = getChildren(ast);\r\n\r\n  let code = `_c('${ast.tag}',${\r\n    ast.attrs.length ? `${genProps(ast.attrs)}` : \"undefined\"\r\n  }${children ? `,${children}` : \"\"})`;\r\n\r\n  return code;\r\n}\r\n","import { parse } from \"./parse\";\r\nimport { generate } from \"./codegen\";\r\nexport function compileToFunctions(template) {\r\n  // 1. æŠŠtemplateè½¬æˆASTè¯­æ³•æ ‘ï¼›ASTç”¨æ¥æè¿°ä»£ç æœ¬èº«å½¢æˆæ ‘ç»“æ„ï¼Œä¸ä»…å¯ä»¥æè¿°htmlï¼Œä¹Ÿèƒ½æè¿°cssä»¥åŠjsè¯­æ³•\r\n  let ast = parse(template);\r\n  console.log(\"AST\", ast);\r\n  // 2. ä¼˜åŒ–é™æ€èŠ‚ç‚¹\r\n  // è¿™ä¸ªæœ‰å…´è¶£çš„å¯ä»¥å»çœ‹æºç   ä¸å½±å“æ ¸å¿ƒåŠŸèƒ½å°±ä¸å®ç°äº†\r\n  //   if (options.optimize !== false) {\r\n  //     optimize(ast, options);\r\n  //   }\r\n\r\n  // 3. é€šè¿‡astï¼Œé‡æ–°ç”Ÿæˆä»£ç \r\n  // æˆ‘ä»¬æœ€åç”Ÿæˆçš„ä»£ç éœ€è¦å’Œrenderå‡½æ•°ä¸€æ ·\r\n  // ç±»ä¼¼_c('div',{id:\"app\"},_c('div',undefined,_v(\"hello\"+_s(name)),_c('span',undefined,_v(\"world\"))))\r\n  // _cä»£è¡¨åˆ›å»ºå…ƒç´  _vä»£è¡¨åˆ›å»ºæ–‡æœ¬ _sä»£è¡¨æ–‡Json.stringify--æŠŠå¯¹è±¡è§£ææˆæ–‡æœ¬\r\n  let code = generate(ast);\r\n  console.log(\"code\", code);\r\n  \r\n  // é€šè¿‡new Functionç”Ÿæˆå‡½æ•°\r\n  let renderFn = new Function(`with(this){return ${code}}`);\r\n  return renderFn;\r\n}\r\n","export function patch() {}","import { patch } from \"./vdom/patch\";\r\n// import Watcher from \"./observer/watcher\";\r\n\r\nexport function lifecycleMixin(Vue) {\r\n  Vue.prototype._update = function (vnode) {\r\n    const vm = this;\r\n    const prevVnode = vm?._vnode; // ä¿ç•™ä¸Šä¸€æ¬¡çš„vnode\r\n    vm._vnode = vnode; // è·å–æœ¬æ¬¡çš„vnode\r\n    if (!prevVnode) {\r\n      // patchæ˜¯æ¸²æŸ“vnodeä¸ºçœŸå®domæ ¸å¿ƒ\r\n      vm.$el = patch(vm.$el, vnode); // åˆæ¬¡æ¸²æŸ“ vm._vnodeè‚¯å®šä¸å­˜åœ¨ è¦é€šè¿‡è™šæ‹ŸèŠ‚ç‚¹ æ¸²æŸ“å‡ºçœŸå®çš„dom èµ‹å€¼ç»™$elå±æ€§\r\n    } else {\r\n      vm.$el = patch(prevVnode, vnode); // æ›´æ–°æ—¶æŠŠä¸Šæ¬¡çš„vnodeå’Œè¿™æ¬¡æ›´æ–°çš„vnodeç©¿è¿›å» è¿›è¡Œdiffç®—æ³•\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * 1. è°ƒç”¨renderæ–¹æ³•ï¼Œç”Ÿæˆè™šæ‹ŸDOM â€”â€” å³æ‰§è¡Œ vm._render()\r\n * 2. å°†VNodeæ¸²æŸ“æˆçœŸå®DOM â€”â€” å³æ‰§è¡Œ vm._update(VNode)\r\n */\r\nexport function mountComponent(vm, el) {\r\n  vm.$el = el;\r\n  // æ‰§è¡ŒbeforeMountç”Ÿå‘½å‘¨æœŸé’©å­\r\n  callHook(vm, \"beforeMount\");\r\n\r\n  let updateComponent = () => {\r\n    vm._update(vm._render());\r\n  };\r\n  updateComponent();\r\n  //   new Watcher(\r\n  //     vm,\r\n  //     updateComponent,\r\n  //     () => {\r\n  //       callHook(vm, \"beforeUpdate\");\r\n  //     },\r\n  //     true\r\n  //   );\r\n  callHook(vm, \"mounted\");\r\n}\r\n\r\nexport function callHook(vm, hook) {\r\n  // ä¾æ¬¡æ‰§è¡Œç”Ÿå‘½å‘¨æœŸå¯¹åº”çš„æ–¹æ³•\r\n  const handlers = vm.$options[hook];\r\n  if (handlers) {\r\n    for (let i = 0; i < handlers.length; i++) {\r\n      handlers[i].call(vm); //ç”Ÿå‘½å‘¨æœŸé‡Œé¢çš„thisæŒ‡å‘å½“å‰å®ä¾‹\r\n    }\r\n  }\r\n}\r\n","/**\r\n * initMixin\r\n * è¡¨ç¤ºåœ¨vueçš„åŸºç¡€ä¸Šåšä¸€æ¬¡æ··åˆæ“ä½œ\r\n */\r\nimport { initState } from \"./state\";\r\nimport { compileToFunctions } from './compiler/index'\r\nimport { callHook, mountComponent } from './lifecycle'\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    // thisæŒ‡å‘å®ä¾‹\r\n    const vm = this;\r\n    vm.$options = options; // åé¢ä¼šå¯¹optionsè¿›è¡Œæ‰©å±•\r\n    callHook(vm, \"beforeCreate\");\r\n    \r\n    // åˆå§‹åŒ–çŠ¶æ€ï¼ŒåŒ…æ‹¬initPropsã€initMethodã€initDataã€initComputedã€initWatchç­‰\r\n    initState(vm);\r\n\r\n    callHook(vm, \"created\");\r\n    // å¦‚æœæœ‰elå±æ€§ è¿›è¡Œæ¨¡æ¿æ¸²æŸ“\r\n    if (vm.$options.el) {\r\n      vm.$mount(vm.$options.el);\r\n    }\r\n  };\r\n\r\n  Vue.prototype.$mount = function (el) {\r\n    // $mount ç”±vueå®ä¾‹è°ƒç”¨ï¼Œæ‰€ä»¥thisæŒ‡å‘vueå®ä¾‹\r\n    const vm = this;\r\n    const options = vm.$options;\r\n    el = document.querySelector(el);\r\n\r\n    /**\r\n     * 1. æŠŠæ¨¡æ¿è½¬åŒ–æˆrenderå‡½æ•°\r\n     * 2. æ‰§è¡Œrenderå‡½æ•°ï¼Œç”ŸæˆVNode\r\n     * 3. æ›´æ–°æ—¶è¿›è¡Œdiff\r\n     * 4. äº§ç”ŸçœŸå®DOM\r\n     */\r\n    // å¯ä»¥ç›´æ¥åœ¨optionsä¸­å†™renderå‡½æ•°ï¼Œå®ƒçš„ä¼˜å…ˆçº§æ¯”templateé«˜\r\n    if (!options.render) {\r\n      let template = options.template;\r\n\r\n      // å¦‚æœä¸å­˜åœ¨renderå’Œtemplateä½†æ˜¯å­˜åœ¨elå±æ€§ï¼Œåˆ™ç›´æ¥å°†templateèµ‹å€¼ä¸ºelå…ƒç´ \r\n      if (!template && el) {\r\n        template = el.outerHTML;\r\n      }\r\n\r\n      // æœ€ç»ˆéœ€è¦æŠŠtempalteæ¨¡æ¿è½¬åŒ–æˆrenderå‡½æ•°\r\n      if (template) {\r\n        // å°†templateè½¬åŒ–æˆrenderå‡½æ•°\r\n        const render = compileToFunctions(template);\r\n        options.render = render;\r\n      }\r\n    }\r\n\r\n    // è°ƒç”¨renderæ–¹æ³•ï¼Œæ¸²æŸ“æˆçœŸå®DOM\r\n    // ç»„ä»¶æŒ‚è½½æ–¹æ³•\r\n    return mountComponent(vm, el);\r\n  };\r\n}\r\n","export function nextTick() {\r\n    console.log('nextTick')\r\n}","import { nextTick } from \"./util/next-tick\";\r\n\r\nexport function renderMixin(Vue) {\r\n  Vue.prototype._c = function (...args) {\r\n    // åˆ›å»ºè™šæ‹Ÿdomå…ƒç´ \r\n    // return createElement(this,...args);\r\n  };\r\n  Vue.prototype._v = function (text) {\r\n    // åˆ›å»ºè™šæ‹Ÿdomæ–‡æœ¬\r\n    // return createTextNode(this,text);\r\n  };\r\n  Vue.prototype._s = function (val) {\r\n    // å¦‚æœæ¨¡æ¿é‡Œé¢çš„æ˜¯ä¸€ä¸ªå¯¹è±¡  éœ€è¦JSON.stringify\r\n    return val == null\r\n      ? \"\"\r\n      : typeof val === \"object\"\r\n      ? JSON.stringify(val)\r\n      : val;\r\n  };\r\n\r\n  Vue.prototype._render = function () {\r\n    const vm = this;\r\n    // è·å–æ¨¡æ¿ç¼–è¯‘ç”Ÿæˆçš„renderæ–¹æ³•\r\n    const { render } = vm.$options;\r\n    console.log(\"ğŸš€ ~ file: render.js ~ line 28 ~ renderMixin ~ render\", render);\r\n    // ç”Ÿæˆvnode--è™šæ‹Ÿdom\r\n    const vnode = render.call(vm);\r\n    return vnode;\r\n  };\r\n\r\n  // æŒ‚è½½åœ¨åŸå‹çš„nextTickæ–¹æ³•\r\n  Vue.prototype.$nextTick = nextTick;\r\n}\r\n","import { initMixin } from \"./init\"\r\nimport { lifecycleMixin } from './lifecycle'\r\nimport { renderMixin } from './render'\r\n\r\nfunction Vue(options) {\r\n    // new Vueåˆ›å»ºå®ä¾‹æ—¶ä¼šè°ƒç”¨_init()æ–¹æ³•\r\n    this._init(options)\r\n}\r\ninitMixin(Vue) // åœ¨åŸå‹ä¸ŠæŒ‚è½½_init()ï¼ˆæ•°æ®ç›‘æ§ï¼›propsã€eventsã€computedã€watchåˆå§‹åŒ–ç­‰ï¼‰ã€$mount()ï¼ˆcompileræµç¨‹ï¼‰æ–¹æ³•\r\nlifecycleMixin(Vue) // åœ¨åŸå‹ä¸ŠæŒ‚è½½ _update()æ–¹æ³•ï¼ˆç¬¬ä¸€æ¬¡åˆ›å»ºdomåŠæ›´æ–°domï¼ˆæœ‰diffè¿‡ç¨‹ï¼‰ï¼‰\r\nrenderMixin(Vue)  //  åœ¨åŸå‹ä¸ŠæŒ‚è½½_cã€_vã€_sã€$nextTickã€_render()æ–¹æ³•\r\n\r\nexport default Vue"],"names":["isFunction","val","isObject","oldArrayPrototype","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","result","call","ob","__ob__","inserted","slice","observeArray","Observer","data","defineProperty","value","enumerable","writable","configurable","isArray","__proto__","walk","item","observe","keys","key","defineReactive","get","set","newVal","initState","vm","opts","$options","props","initData","computed","watch","_data","proxy","source","newValue","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","attribute","parse","template","root","currentParent","stack","ELEMENT_TYPE","TEXT_TYPE","createASTElement","tagName","attrs","tag","type","children","parent","handleStartTag","element","push","handleEndTag","pop","Error","length","handleChars","text","replace","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","start","end","attr","name","n","defaultTagRE","gen","node","generate","test","JSON","stringify","lastIndex","tokens","index","exec","trim","join","getChildren","el","map","c","genProps","str","i","obj","split","ast","code","compileToFunctions","console","log","renderFn","Function","patch","lifecycleMixin","Vue","_update","vnode","prevVnode","_vnode","$el","mountComponent","callHook","updateComponent","_render","hook","handlers","initMixin","_init","options","$mount","document","querySelector","render","outerHTML","nextTick","renderMixin","_c","_v","_s","$nextTick"],"mappings":"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"}