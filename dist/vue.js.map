{"version":3,"file":"vue.js","sources":["../src/global-api/const.js","../src/util/index.js","../src/observer/array.js","../src/observer/dep.js","../src/observer/index.js","../src/util/next-tick.js","../src/observer/scheduler.js","../src/observer/watcher.js","../src/state.js","../src/compiler/parse.js","../src/compiler/codegen.js","../src/compiler/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/global-api/mixin.js","../src/global-api/extend.js","../src/global-api/assets.js","../src/global-api/index.js","../src/index.js"],"sourcesContent":["export const ASSETS_TYPE = [\"component\", \"directive\", \"filter\"];","import { ASSETS_TYPE } from \"../global-api/const\";\r\n\r\nexport const LIFECYCLE_HOOKS = [\r\n  \"beforeCreate\",\r\n  \"created\",\r\n  \"beforeMount\",\r\n  \"mounted\",\r\n  \"beforeUpdate\",\r\n  \"updated\",\r\n  \"beforeDestroy\",\r\n  \"destroyed\",\r\n];\r\n\r\nconst strats = {}; // å­˜æ”¾å„ç§ç­–ç•¥\r\n// ç”Ÿå‘½å‘¨æœŸçš„åˆå¹¶ç­–ç•¥\r\nfunction mergeHook(parentVal, childVal) {\r\n  if (childVal) {\r\n    if (parentVal) {\r\n      // ç®€å•è¯´å°±æ˜¯æ•°ç»„çš„åˆå¹¶\r\n      return parentVal.concat(childVal);  // åç»­åˆå¹¶\r\n    } else {\r\n      return [childVal];  // ç¬¬ä¸€æ¬¡åˆå¹¶ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼ˆå› ä¸ºç¬¬ä¸€æ¬¡åˆå¹¶æ—¶ï¼ŒVue.optionsä¸ºç©ºå¯¹è±¡ï¼ŒparentValä¸ºundefinedï¼Œä¼šèµ°è¿™ä¸€æ­¥ï¼‰\r\n    }\r\n  } else {\r\n    return parentVal;\r\n  }\r\n}\r\nLIFECYCLE_HOOKS.forEach((hook) => {\r\n  strats[hook] = mergeHook;\r\n})\r\n\r\n// componentsã€directivesã€filtersçš„åˆå¹¶ç­–ç•¥\r\nfunction mergeAssets(parentVal, childVal) {\r\n  // æ¯”å¦‚æœ‰ã€åŒåã€‘çš„å…¨å±€ç»„ä»¶å’Œè‡ªå·±å®šä¹‰çš„å±€éƒ¨ç»„ä»¶ï¼Œé‚£ä¹ˆparentValä»£è¡¨å…¨å±€ç»„ä»¶ï¼Œè‡ªå·±å®šä¹‰çš„ç»„ä»¶æ˜¯childVal\r\n  // é¦–å…ˆä¼šæŸ¥æ‰¾è‡ªå·²å±€éƒ¨ç»„ä»¶æœ‰å°±ç”¨è‡ªå·±çš„ï¼Œæ²¡æœ‰å°±ä»åŸå‹ç»§æ‰¿å…¨å±€ç»„ä»¶ï¼Œres.__proto__===parentVal\r\n  const res = Object.create(parentVal); \r\n  if (childVal) {\r\n    for (let k in childVal) {\r\n      res[k] = childVal[k];\r\n    }\r\n  }\r\n  return res;\r\n}\r\nASSETS_TYPE.forEach((type) => {\r\n  strats[type + \"s\"] = mergeAssets;\r\n});\r\n\r\nexport function mergeOptions(parent, child) {\r\n  const options = {}; // åˆå¹¶åçš„ç»“æœ\r\n  /**\r\n   * éå†çˆ¶å­optionä¸­æ‰€æœ‰çš„å±æ€§ï¼Œè°ƒç”¨mergeFiledè¿›è¡Œåˆå¹¶\r\n   */\r\n  for (let k in parent) {   // éå†çˆ¶äº²æ‰€æœ‰å±æ€§ï¼Œè¿›è¡Œåˆå¹¶\r\n    mergeFiled(k);\r\n  }\r\n\r\n  for (let k in child) {   // éå†å„¿å­ï¼›å¯¹å„¿å­æœ‰ã€çˆ¶äº²æ²¡æœ‰çš„å±æ€§ï¼ŒåŒæ ·è¿›è¡Œåˆå¹¶\r\n    if (!parent.hasOwnProperty(k)) {\r\n      mergeFiled(k);\r\n    }\r\n  }\r\n\r\n  // çœŸæ­£è¿›è¡Œå±æ€§åˆå¹¶çš„æ–¹æ³•\r\n  function mergeFiled(key) {\r\n    let parentVal = parent[key]\r\n    let childVal = child[key]\r\n    // 1. ä½¿ç”¨ã€ç­–ç•¥æ¨¡å¼ã€‘å¤„ç†ç”Ÿå‘½å‘¨æœŸï¼šç”Ÿå‘½å‘¨æœŸçš„åˆå¹¶ï¼Œéœ€è¦åˆå¹¶æˆæ•°ç»„\r\n    if(strats[key]) {\r\n      // ä¸åŒç­–ç•¥è°ƒç”¨å¯¹åº”çš„æ–¹æ³• æ¥åˆå¹¶parentValå’ŒchildVal\r\n      options[key] = strats[key](parentVal, childVal);\r\n    } else {\r\n      // 2. ç”Ÿå‘½å‘¨æœŸå¤–å…¶ä»–æ•°æ®çš„åˆå¹¶\r\n\r\n      // å¦‚æœparentValå’ŒchildValéƒ½æ˜¯å¯¹è±¡çš„è¯ï¼Œåˆ™è¿›è¡Œå¯¹è±¡çš„åˆå¹¶\r\n      if(isObject(parentVal) && isObject(childVal)) {\r\n        options[key] = {...parentVal, ...childVal}\r\n      } else {\r\n        // å¦‚æœæœ‰ä¸€æ–¹ä¸ºåŸºæœ¬æ•°æ®ç±»å‹/å‡½æ•°\r\n        // å„¿å­æœ‰åˆ™ä»¥å„¿å­ä¸ºå‡†ï¼›\r\n        // å„¿å­æ²¡æœ‰ï¼Œçˆ¶äº²æœ‰ï¼Œåˆ™å–çˆ¶äº²çš„å±æ€§\r\n        options[key] = childVal || parentVal\r\n      }\r\n    }\r\n  }\r\n  // çœŸæ­£åˆå¹¶å­—æ®µæ–¹æ³•\r\n  // function mergeFiled(k) {\r\n  //   // ã€ç­–ç•¥æ¨¡å¼ã€‘\r\n  //   if (strats[k]) {  // å¦‚æœæœ‰å¯¹åº”çš„ç­–ç•¥\r\n  //     options[k] = strats[k](parent[k], child[k]);\r\n  //   } else {\r\n  //     // é»˜è®¤ç­–ç•¥\r\n  //     options[k] = child[k] ? child[k] : parent[k];\r\n  //   }\r\n  // }\r\n  return options\r\n}\r\n\r\n// åˆ¤æ–­valæ˜¯å¦æ˜¯å¯¹è±¡/æ•°ç»„\r\nexport function isObject(val) {\r\n  return typeof val === \"object\" && val !== null;\r\n}\r\n\r\n// åˆ¤æ–­æ˜¯å¦æ˜¯å‡½æ•°\r\nexport function isFunction(val) {\r\n  return typeof val === \"function\";\r\n}\r\n\r\n// åˆ¤æ–­tagNameæ˜¯å¦æ˜¯æ™®é€šæ ‡ç­¾\r\nexport function isReservedTag(tagName) {\r\n  // å®šä¹‰å¸¸è§æ ‡ç­¾\r\n  let str =\r\n    \"html,body,base,head,link,meta,style,title,\" +\r\n    \"address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,\" +\r\n    \"div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,\" +\r\n    \"a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,\" +\r\n    \"s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,\" +\r\n    \"embed,object,param,source,canvas,script,noscript,del,ins,\" +\r\n    \"caption,col,colgroup,table,thead,tbody,td,th,tr,\" +\r\n    \"button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,\" +\r\n    \"output,progress,select,textarea,\" +\r\n    \"details,dialog,menu,menuitem,summary,\" +\r\n    \"content,element,shadow,template,blockquote,iframe,tfoot\";\r\n  let obj = {};\r\n  str.split(\",\").forEach((tag) => {\r\n    obj[tag] = true;\r\n  });\r\n  return obj[tagName];\r\n}\r\n","// arrayMethodsæ˜¯ç»§æ‰¿è‡ªArray.prototypeï¼Œä¸ç›´æ¥ä¿®æ”¹Array.prototypeï¼Œä¸æ±¡æŸ“Array.prototype\r\nlet oldArrayPrototype = Array.prototype\r\nexport let arrayMethods = Object.create(oldArrayPrototype)\r\n\r\nlet methods = [\r\n    'push',\r\n    'pop',\r\n    'unshift',\r\n    'shift',\r\n    'sort',\r\n    'reverse',\r\n    'splice'\r\n]\r\n\r\nmethods.forEach(method => {\r\n    arrayMethods[method] = function(...args) {\r\n        const result = oldArrayPrototype[method].call(this,...args) // thisæŒ‡å‘è°ƒç”¨è¯¥æ–¹æ³•çš„dataï¼ˆå³ç»è¿‡å“åº”å¼å¤„ç†çš„æ•°ç»„ï¼‰\r\n\r\n        // å¯¹äºæ•°ç»„ä¸­æ–°å¢çš„å…ƒç´ ï¼Œä¹Ÿéœ€è¦è¿›è¡Œç›‘æ§\r\n        const ob = this.__ob__;\r\n        let inserted;\r\n        switch (method) {\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;\r\n                break;\r\n            case \"splice\":\r\n                inserted = args.slice(2);\r\n            default:\r\n                break;\r\n        }\r\n        // insertedæ˜¯ä¸ªæ•°ç»„ï¼Œéœ€è¦è°ƒç”¨observeArrayæ¥ç›‘æµ‹\r\n        if (inserted) ob.observeArray(inserted);\r\n\r\n        // æ•°ç»„æ´¾å‘æ›´æ–°\r\n        ob.dep.notify()\r\n        return result\r\n    }\r\n})","/**\r\n * 1. æ¯ä¸ªå±æ€§æˆ‘éƒ½ç»™ä»–åˆ†é…ä¸€ä¸ªdepï¼ˆä¸€å¯¹ä¸€çš„å…³ç³»ï¼‰ï¼Œä¸€ä¸ªdepå¯ä»¥å­˜æ”¾å¤šä¸ªwatcherï¼ˆä¸€ä¸ªå±æ€§å¯èƒ½å¯¹åº”å¤šä¸ªwatcherï¼‰\r\n * 2. ä¸€ä¸ªwatcherä¸­è¿˜å¯ä»¥å­˜æ”¾å¤šä¸ªdepï¼ˆä¸€ä¸ªwatcherå¯èƒ½å¯¹åº”å¤šä¸ªå±æ€§ï¼Œè€Œdepä¸å±æ€§ä¸€ä¸€å¯¹åº”ï¼‰\r\n * 3. depå…·æœ‰å”¯ä¸€æ€§\r\n */\r\nlet id = 0; // ç»™depæ·»åŠ ä¸€ä¸ªæ ‡è¯†ï¼Œä¿è¯å®ƒçš„å”¯ä¸€æ€§\r\nexport default class Dep {\r\n  constructor() {\r\n    this.id = id++;\r\n    this.subs = [];  // ç”¨æ¥å­˜æ”¾watcher\r\n  }\r\n\r\n  // å°†depå®ä¾‹æ”¾åˆ°watcherä¸­\r\n  depend() {\r\n    // å¦‚æœå½“å‰å­˜åœ¨watcher\r\n    if (Dep.target) {\r\n      // Dep.targetå³å½“å‰watcherï¼Œæ˜¯åœ¨new Watcheræ—¶è®¾ç½®çš„\r\n      Dep.target.addDep(this); // thisä¸ºdepå®ä¾‹ï¼ˆä¸å±æ€§ä¸€ä¸€å¯¹åº”ï¼‰ï¼Œå³æŠŠè‡ªèº«depå®ä¾‹å­˜æ”¾åœ¨watcheré‡Œé¢\r\n    }\r\n  }\r\n\r\n  // ä¾æ¬¡æ‰§è¡Œsubsé‡Œé¢çš„watcheræ›´æ–°æ–¹æ³•\r\n  notify() {\r\n    this.subs.forEach((watcher) => watcher.update());\r\n  }\r\n\r\n  // æŠŠwatcheråŠ å…¥åˆ°depå®ä¾‹çš„subså®¹å™¨ï¼ˆå› ä¸ºä¸€ä¸ªdepå¯èƒ½å¯¹åº”å¤šä¸ªwatcherï¼‰\r\n  addSub(watcher) {\r\n    this.subs.push(watcher);\r\n  }\r\n}\r\n\r\n/**\r\n * targetStackå®šä¹‰åœ¨å…¨å±€ï¼Œä¸ºæ•´ä¸ªé¡¹ç›®æ‰€æœ‰watcher\r\n * Dep.targetå®šä¹‰åœ¨Depè‡ªèº«è€Œéprototypeä¸Šï¼Œæ— æ³•è¢«å®ä¾‹ç»§æ‰¿ï¼Œæ ‡è¯†å½“å‰çš„watcherï¼Œå…·æœ‰å”¯ä¸€æ€§\r\n */\r\n// æ ˆç»“æ„ç”¨æ¥å­˜ä¼—å¤šwatcher\r\nconst targetStack = [];\r\n// Dep.target ä¸º dep å½“å‰æ‰€å¯¹åº”çš„watcherï¼ˆå³æ ˆé¡¶çš„watcherï¼‰ï¼Œé»˜è®¤ä¸ºnull\r\nDep.target = null;\r\n\r\nexport function pushTarget(watcher) {\r\n  targetStack.push(watcher);\r\n  Dep.target = watcher; // Dep.targetæŒ‡å‘å½“å‰watcher\r\n}\r\n\r\nexport function popTarget() {\r\n  // targetStackå¯èƒ½åŒæ—¶å­˜åœ¨å¤šä¸ªwatcherï¼ˆæ¯”å¦‚æ¸²æŸ“watcherå¤„äºæ ˆåº•ï¼Œä¸Šé¢æœ‰computed watcherï¼‰\r\n  targetStack.pop(); // å½“å‰watcherå‡ºæ ˆ æ‹¿åˆ°ä¸Šä¸€ä¸ªwatcher\r\n  Dep.target = targetStack[targetStack.length - 1];\r\n}\r\n","import { isObject } from \"../util/index\";\r\nimport { arrayMethods } from \"./array\";\r\nimport Dep from \"./dep\";\r\n\r\n/**\r\n * æ•°æ®åŠ«æŒï¼š\r\n * 1. å¦‚æœæ˜¯å¯¹è±¡ï¼Œåˆ™é€’å½’å¯¹è±¡æ‰€æœ‰å±æ€§ï¼Œè¿›è¡ŒåŠ«æŒ\r\n * 2. å¦‚æœæ•°ç»„ï¼Œåˆ™ä¼šåŠ«æŒæ•°ç»„æ–¹æ³•ï¼ˆæ–¹æ³•ä¸­å¦‚æœæ˜¯æ–°å¢å…ƒç´ ï¼Œä¼šåŠ«æŒæ–°å¢å…ƒç´ ï¼‰ï¼Œå¹¶å¯¹æ•°ç»„ä¸­ç±»å‹ä¸ºæ•°ç»„/å¯¹è±¡çš„å…ƒç´ è¿›è¡ŒåŠ«æŒ\r\n */\r\n\r\nclass Observer {\r\n  // é€šè¿‡newå‘½ä»¤ç”Ÿæˆclasså®ä¾‹æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨constructor()ï¼Œå³ä¼šæ‰§è¡Œthis.walk(data)æ–¹æ³•\r\n  constructor(data) {\r\n    this.value = data\r\n    this.dep = new Dep(); // ç»™dataæ·»åŠ ä¸€ä¸ªdepï¼Œæ”¶é›†dataæ•´ä½“çš„ä¸€ä¸ªdepï¼ˆä¸»è¦ç”¨äºæ•°ç»„çš„ä¾èµ–æ”¶é›†ï¼‰\r\n\r\n    // åœ¨æ•°æ®dataä¸Šæ–°å¢å±æ€§ data.__ob__ï¼›æŒ‡å‘ç»è¿‡new Observer(data)åˆ›å»ºçš„å®ä¾‹ï¼Œå¯ä»¥è®¿é—®Observer.prototypeä¸Šçš„æ–¹æ³•observeArrayã€walkç­‰\r\n    // æ‰€æœ‰è¢«åŠ«æŒè¿‡çš„æ•°æ®éƒ½æœ‰__ob__å±æ€§ï¼ˆé€šè¿‡è¿™ä¸ªå±æ€§å¯ä»¥åˆ¤æ–­æ•°æ®æ˜¯å¦è¢«æ£€æµ‹è¿‡ï¼‰\r\n    Object.defineProperty(data, \"__ob__\", {\r\n      // å€¼æŒ‡ä»£çš„å°±æ˜¯Observerçš„å®ä¾‹ï¼Œå³ç›‘æ§çš„æ•°æ®\r\n      value: this,\r\n      //  è®¾ä¸ºä¸å¯æšä¸¾ï¼Œé˜²æ­¢åœ¨forEachå¯¹æ¯ä¸€é¡¹å“åº”å¼çš„æ—¶å€™ç›‘æ§__ob__ï¼Œé€ æˆæ­»å¾ªç¯\r\n      enumerable: false,\r\n      writable: true,\r\n      configurable: true,\r\n    });\r\n\r\n    /**\r\n     * æ€è€ƒä¸€ä¸‹æ•°ç»„å¦‚ä½•è¿›è¡Œå“åº”å¼ï¼Ÿ\r\n     * å’Œå¯¹è±¡ä¸€æ ·ï¼Œå¯¹æ¯ä¸€ä¸ªå±æ€§è¿›è¡Œä»£ç†å—ï¼Ÿ\r\n     * å¦‚æœæ•°ç»„é•¿åº¦ä¸º10000ï¼Œç»™æ¯ä¸€é¡¹è®¾ç½®ä»£ç†ï¼Œæ€§èƒ½éå¸¸å·®ï¼\r\n     * ç”¨æˆ·å¾ˆå°‘é€šè¿‡ç´¢å¼•æ“ä½œæ•°ç»„ï¼Œæˆ‘ä»¬åªéœ€è¦é‡å†™æ•°ç»„çš„åŸå‹æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­è¿›è¡Œå“åº”å¼å³å¯ã€‚\r\n     */\r\n    if (Array.isArray(data)) {\r\n      // æ•°ç»„å“åº”å¼å¤„ç†\r\n      // é‡å†™æ•°ç»„çš„åŸå‹æ–¹æ³•ï¼Œå°†dataåŸå‹æŒ‡å‘é‡å†™åçš„å¯¹è±¡\r\n      data.__proto__ = arrayMethods;\r\n\r\n      // å¦‚æœæ•°ç»„ä¸­çš„æ•°æ®æ˜¯å¯¹è±¡ï¼Œéœ€è¦ç›‘æ§å¯¹è±¡çš„å˜åŒ–\r\n      this.observeArray(data);\r\n    } else {\r\n      // å¯¹è±¡å“åº”å¼å¤„ç†\r\n      this.walk(data);\r\n    }\r\n  }\r\n  observeArray(data) {\r\n    // ã€å…³é”®ã€‘é€’å½’äº†ï¼Œç›‘æ§æ•°ç»„æ¯ä¸€é¡¹ï¼ˆobserveä¼šç­›é€‰å‡ºå¯¹è±¡å’Œæ•°ç»„ï¼Œå…¶ä»–çš„ä¸ç›‘æ§ï¼‰çš„æ”¹å˜ï¼Œæ•°ç»„é•¿åº¦å¾ˆé•¿çš„è¯ï¼Œä¼šå½±å“æ€§èƒ½\r\n    // ã€*********ã€‘æ•°ç»„å¹¶æ²¡æœ‰å¯¹ç´¢å¼•è¿›è¡Œç›‘æ§ï¼Œä½†æ˜¯å¯¹æ•°ç»„çš„åŸå‹æ–¹æ³•è¿›è¡Œäº†æ”¹å†™ï¼Œè¿˜å¯¹æ¯ä¸€é¡¹ï¼ˆæ•°ç»„å’Œå¯¹è±¡ç±»å‹ï¼‰è¿›è¡Œäº†ç›‘æ§\r\n    data.forEach((item) => {\r\n      observe(item);\r\n    });\r\n  }\r\n  walk(data) {\r\n    Object.keys(data).forEach((key) => {\r\n      // å¯¹dataä¸­çš„æ¯ä¸ªå±æ€§è¿›è¡Œå“åº”å¼å¤„ç†\r\n      defineReactive(data, key, data[key]);\r\n    });\r\n  }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n  let childOb =  observe(value); // ã€å…³é”®ã€‘é€’å½’ï¼ŒåŠ«æŒå¯¹è±¡ä¸­æ‰€æœ‰å±‚çº§çš„æ‰€æœ‰å±æ€§\r\n  // å¦‚æœVueæ•°æ®åµŒå¥—å±‚çº§è¿‡æ·± >> æ€§èƒ½ä¼šå—å½±å“ã€******************************ã€‘\r\n\r\n  let dep = new Dep() // ä¸ºæ¯ä¸ªå±æ€§åˆ›å»ºä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„dep\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      if(Dep.target) {\r\n        dep.depend()\r\n        // å¦‚æœå±æ€§çš„å€¼ä¾ç„¶æ˜¯ä¸€ä¸ªæ•°ç»„/å¯¹è±¡ï¼Œåˆ™å¯¹è¯¥ æ•°ç»„/å¯¹è±¡ æ•´ä½“è¿›è¡Œä¾èµ–æ”¶é›†\r\n        if(childOb) {\r\n          childOb.dep.depend(); // è®©å¯¹è±¡å’Œæ•°ç»„ä¹Ÿè®°å½•watcher\r\n          // å¦‚æœæ•°æ®ç»“æ„ç±»ä¼¼ {a:[1,2,[3,4,[5,6]]]} è¿™ç§æ•°ç»„å¤šå±‚åµŒå¥—ï¼Œæ•°ç»„åŒ…å«æ•°ç»„çš„æƒ…å†µï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¿é—®açš„æ—¶å€™ï¼Œåªæ˜¯å¯¹ç¬¬ä¸€å±‚çš„æ•°ç»„è¿›è¡Œäº†ä¾èµ–æ”¶é›†\r\n          // é‡Œé¢çš„æ•°ç»„å› ä¸ºæ²¡è®¿é—®åˆ°ï¼Œæ‰€ä»¥æ— æ³•æ”¶é›†ä¾èµ–ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ”¹å˜äº†aé‡Œé¢çš„ç¬¬äºŒå±‚æ•°ç»„çš„å€¼ï¼Œæ˜¯éœ€è¦æ›´æ–°é¡µé¢çš„ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ•°ç»„é€’å½’è¿›è¡Œä¾èµ–æ”¶é›†\r\n          if (Array.isArray(value)) {\r\n            // å¦‚æœå†…éƒ¨è¿˜æ˜¯æ•°ç»„\r\n            dependArray(value); // éå† + é€’å½’æ•°ç»„ï¼Œå¯¹æ•°ç»„ä¸åŒå±‚çº§çš„æ‰€æœ‰æ•°ç»„å…ƒç´  è¿›è¡Œä¾èµ–æ”¶é›†\r\n          }\r\n        }\r\n      }\r\n      return value;\r\n    },\r\n    set(newVal) {\r\n      if (newVal === value) return;\r\n      // å¯¹æ–°æ•°æ®è¿›è¡Œè§‚å¯Ÿ\r\n      observe(newVal);\r\n      value = newVal;\r\n      console.log('-------------------æ•°æ®æ›´æ–°ï¼Œé€šçŸ¥watchersæ›´æ–°-------------------')\r\n      dep.notify(); // é€šçŸ¥depå­˜æ”¾çš„watcherå»æ›´æ–°--æ´¾å‘æ›´æ–°\r\n    },\r\n  });\r\n}\r\n\r\n// é€’å½’æ”¶é›†æ•°ç»„ä¾èµ–\r\nfunction dependArray(value) {\r\n  for (let e, i = 0, l = value.length; i < l; i++) {\r\n    e = value[i];\r\n    // å¯¹æ¯ä¸€é¡¹è¿›è¡Œä¾èµ–æ”¶é›†\r\n    e && e.__ob__ && e.__ob__.dep.depend();\r\n    if (Array.isArray(e)) {\r\n      // ã€é€’å½’ã€‘å¦‚æœæ•°ç»„é‡Œé¢è¿˜æœ‰æ•°ç»„ï¼Œå°±é€’å½’å»æ”¶é›†ä¾èµ–\r\n      dependArray(e);\r\n    }\r\n  }\r\n}\r\n\r\nexport function observe(data) {\r\n  // å¦‚æœæ˜¯objectç±»å‹ï¼ˆå¯¹è±¡æˆ–æ•°ç»„ï¼‰æ‰è§‚æµ‹ï¼›ç¬¬ä¸€æ¬¡è°ƒç”¨observe(vm.$options._data)æ—¶ï¼Œ_dataä¸€å®šæ˜¯ä¸ªå¯¹è±¡ï¼Œå®˜æ–¹è¦æ±‚çš„å†™æ³•ï¼ˆdataå‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼‰\r\n  if (!isObject(data)) {\r\n    return;\r\n  }\r\n  // å¦‚æœå·²ç»æ˜¯å“åº”å¼çš„æ•°æ®ï¼Œç›´æ¥return\r\n  if (data.__ob__) {\r\n    return data.__ob__;\r\n  }\r\n  // è¿”å›ç»è¿‡å“åº”å¼å¤„ç†ä¹‹åçš„data\r\n  return new Observer(data);\r\n}\r\n","const callbacks = [];\r\nfunction flushCallbacks() {\r\n  callbacks.forEach((cb) => cb());\r\n  waiting = false;\r\n}\r\nlet waiting = false;\r\n/**\r\n * æµç¨‹ï¼š\r\n * 1. watcheræ›´æ–°æµç¨‹ï¼š\r\n *       â€”â€”> watcher.update()\r\n *       â€”â€”> queueWatcher(watcher)\r\n *       â€”â€”> å¯¹watcherå»é‡ï¼Œå¹¶å°†watcheræ”¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼›æœ€åæ‰§è¡Œ nextTick(flushSchedulerQueue)ï¼ˆflushSchedulerQueueçš„ä½œç”¨æ˜¯éå†watcheræ•°ç»„ï¼Œè°ƒç”¨watcher.run()ï¼‰\r\n *       â€”â€”> å°† flushSchedulerQueue æ”¾å…¥ä¸€ä¸ª å›è°ƒå‡½æ•°æ•°ç»„callbacks ä¸­ï¼›å®šä¹‰ä¸€ä¸ªå¾®ä»»åŠ¡ï¼šflushCallbacks(callbacks)ï¼›\r\n * 2. vm.$nextTick(cb)ï¼š\r\n *       â€”â€”> ç›´æ¥ä¼šæ‰§è¡ŒVueåŸå‹ä¸Šçš„$nextTick()æ–¹æ³•ï¼Œå³nextTick(cb)æ–¹æ³•\r\n *       â€”â€”> å°†cb æ”¾å…¥ ä¸Šè¿°çš„å›è°ƒå‡½æ•°æ•°ç»„ callbacks ä¸­ï¼Œç´§æ¥ç€ä¸Šè¿°çš„flushSchedulerQueueï¼Œåœ¨å¾®ä»»åŠ¡ä¸­ä¸€å¹¶æ‰§è¡Œ\r\n *       â€”â€”> ç”±äºåœ¨flushSchedulerQueueä¸­ä¼šæ‰§è¡Œ watcher.run() åˆ›å»ºçœŸå®DOMï¼Œæ‰€ä»¥å¯ä»¥åœ¨$nextTick()å›è°ƒä¸­è·å–åˆ°æœ€æ–°DOMèŠ‚ç‚¹\r\n * \r\n * æ€»ç»“ï¼š\r\n * 1. callbacks ä¸­åŒ…å« flushSchedulerQueueï¼Œä»¥åŠ$nextTick()çš„å›è°ƒ\r\n * 2. dep.subsä¸­æ¯ä¸ªwatcheræ‰§è¡Œupdateæ—¶ï¼Œæœ€åéƒ½ä¼šæ‰§è¡Œnextickï¼Œ\r\n * 3. æ‰§è¡Œnextickæ˜¯å¦ä¼šåˆ›å»ºå¾®ä»»åŠ¡ï¼Œå–å†³äºä¸Šä¸€ä¸ªå¾®ä»»åŠ¡æ˜¯å¦å®Œæˆ\r\n * 4. æ‰§è¡Œå¾®ä»»åŠ¡åœ¨UIæ¸²æŸ“å®Œæˆä¹‹å‰ï¼Œä¸ºä½•èƒ½æ‹¿åˆ°é¡µé¢domï¼Ÿï¼šï¼šï¼š$nextTick()å›è°ƒä¸­è·å–çš„æ—¶å†…å­˜ä¸­çš„DOMï¼Œä¸å…³å¿ƒUIæœ‰æ²¡æœ‰æ¸²æŸ“å®Œæˆ\r\n */\r\nexport function nextTick(cb) {\r\n  callbacks.push(cb);\r\n\r\n  if (!waiting) {\r\n    // å¼‚æ­¥æ‰§è¡ŒcallBacks\r\n    Promise.resolve().then(flushCallbacks);\r\n    waiting = true;\r\n  }\r\n}\r\n","import { nextTick } from \"../util/next-tick\";\r\n\r\nlet queue = [];\r\nlet has = {}; // ç»´æŠ¤å­˜æ”¾äº†å“ªäº›watcher\r\n\r\n/**\r\n * queueWatcheré€»è¾‘ï¼š\r\n * 1. å¯¹watcherå»é‡ï¼ˆæœ‰ç›¸åŒwatcherçš„æƒ…å†µä¸‹ï¼Œä¸é‡å¤pushï¼‰\r\n * 2. é˜²æŠ–ï¼šä¸€æ®µæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡çš„æ›´æ–°ï¼ˆéå†æ‰€æœ‰watcherï¼Œæ‰§è¡Œwatcher.run()ï¼‰\r\n */\r\nexport function queueWatcher(watcher) {\r\n  const id = watcher.id;\r\n\r\n  // watcherå»é‡ï¼Œå³ç›¸åŒwatcheråªpushä¸€æ¬¡\r\n  if (!has[id]) {\r\n    //  åŒæ­¥ä»£ç æ‰§è¡Œ æŠŠå…¨éƒ¨çš„watcheréƒ½æ”¾åˆ°é˜Ÿåˆ—é‡Œé¢å»\r\n    queue.push(watcher);\r\n    has[id] = true;\r\n\r\n    // å¼€å¯ä¸€æ¬¡å¼‚æ­¥æ›´æ–°æ“ä½œï¼Œæ‰¹å¤„ç†ï¼ˆé˜²æŠ–ï¼‰\r\n    // è¿›è¡Œå¼‚æ­¥è°ƒç”¨\r\n    nextTick(flushSchedulerQueue);\r\n  }\r\n}\r\n\r\nfunction flushSchedulerQueue() {\r\n  for (let index = 0; index < queue.length; index++) {\r\n    // è°ƒç”¨watcherçš„runæ–¹æ³•ï¼Œæ‰§è¡ŒçœŸæ­£çš„æ›´æ–°æ“ä½œ\r\n    queue[index].run();\r\n  }\r\n\r\n  // æ‰§è¡Œå®Œä¹‹åæ¸…ç©ºé˜Ÿåˆ—\r\n  queue = [];\r\n  has = {};\r\n}\r\n","import { pushTarget, popTarget } from \"./dep\";\r\nimport { queueWatcher } from \"./scheduler\";\r\nimport { isObject } from \"../util/index\";\r\n\r\n// å…¨å±€å˜é‡id  æ¯æ¬¡new Watcheréƒ½ä¼šè‡ªå¢\r\nlet id = 0;\r\nexport default class Watcher {\r\n  constructor(vm, exprOrFn, cb, options) {\r\n    this.vm = vm;\r\n    this.exprOrFn = exprOrFn;\r\n    this.cb = cb;\r\n    this.options = options;\r\n    this.user = !!options.user; // è¡¨ç¤ºæ˜¯ä¸æ˜¯ç”¨æˆ·watcher\r\n    this.lazy = !!options.lazy; // è¡¨ç¤ºæ˜¯ä¸æ˜¯computed watcher\r\n    this.dirty = this.lazy; // dirtyå¯å˜ï¼Œé»˜è®¤ä¸ºtrueï¼›è¡¨ç¤ºè®¡ç®—watcheræ˜¯å¦éœ€è¦é‡æ–°è®¡ç®—-æ‰§è¡Œç”¨æˆ·å®šä¹‰çš„æ–¹æ³•ã€‚\r\n\r\n    this.id = id++; // watcherçš„å”¯ä¸€æ ‡è¯†\r\n\r\n    this.deps = []; //å­˜æ”¾depçš„å®¹å™¨\r\n    this.depsId = new Set(); //ç”¨æ¥å»é‡dep\r\n\r\n    /**\r\n     * 1. æ¸²æŸ“watcherä¸­ï¼ŒexprOrFnä¸ºupdateComponent()ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°\r\n     * 2. åœ¨ç”¨æˆ·watcherä¸­ï¼ŒexprOrFnä¸ºå­—ç¬¦ä¸²ï¼ˆwatchä¸­çš„å±æ€§åï¼Œå³ç›‘å¬åœ°å±æ€§ï¼‰\r\n     */\r\n    // å½“æ˜¯æ¸²æŸ“watcher æˆ– computed watcheræ—¶\r\n    if (typeof exprOrFn === \"function\") {\r\n      this.getter = exprOrFn;\r\n    } else {\r\n      // å½“æ˜¯ç”¨æˆ·è‡ªå®šä¹‰watcheræ—¶\r\n      this.getter = function () {\r\n        // watchçš„keyå¯èƒ½æ˜¯ 'obj1.a.d' è¿™ç§æ ¼å¼ï¼Œéœ€è¦å¤„ç†æˆvm.obj1.a.d\r\n        let path = exprOrFn.split(\".\");\r\n        let obj = vm;\r\n        for (let i = 0; i < path.length; i++) {\r\n          obj = obj[path[i]]; //vm.a.a.a.a.b\r\n        }\r\n        return obj; // æ‰§è¡Œgetter()ï¼Œè¿”å›objï¼Œä¼šè§¦å‘ä¾èµ–æ”¶é›†ï¼Œå°†ç”¨æˆ·watcheræ”¶é›†åˆ°ç›‘å¬çš„æ•°æ®ä¸Š\r\n      };\r\n    }\r\n\r\n    // å¦‚æœæ˜¯è®¡ç®—å±æ€§watcherï¼Œåˆ™åˆ›å»ºwatcherçš„æ—¶å€™ï¼Œä»€ä¹ˆéƒ½ä¸æ‰§è¡Œï¼ˆåç»­ç”¨åˆ°è®¡ç®—å±æ€§çš„æ—¶å€™å†æ‰§è¡Œï¼‰\r\n    this.value = this.lazy ? undefined : this.get();\r\n  }\r\n\r\n  // new Watcheræ—¶ä¼šæ‰§è¡Œgetæ–¹æ³•ï¼›ä¹‹åæ•°æ®æ›´æ–°æ—¶ï¼Œç›´æ¥æ‰‹åŠ¨è°ƒç”¨getæ–¹æ³•å³å¯\r\n  get() {\r\n    // æŠŠå½“å‰watcheræ”¾åˆ°å…¨å±€æ ˆï¼Œå¹¶è®¾ç½®Dep.targetï¼ˆæ— æ³•ç»§æ‰¿ï¼Œå…·å”¯ä¸€æ€§ï¼‰ä¸ºå½“å‰watcher\r\n    pushTarget(this);\r\n    /**\r\n     * æ‰§è¡ŒexprOrFnï¼Œå¦‚æœwatcheræ˜¯æ¸²æŸ“watcherï¼Œåˆ™exprOrFnä¸ºvm._update(vm._render())\r\n     * åœ¨æ‰§è¡Œrenderå‡½æ•°çš„æ—¶å€™ï¼Œè·å–å˜é‡ä¼šè§¦å‘å±æ€§çš„getterï¼ˆå®šä¹‰åœ¨å¯¹è±¡æ•°æ®åŠ«æŒä¸­ï¼‰ï¼Œåœ¨getterä¸­è¿›è¡Œä¾èµ–æ”¶é›†\r\n     */\r\n    const res = this.getter.call(this.vm); // å¦‚æœæ˜¯ç”¨æˆ·watcherï¼Œåˆ™ä¸Šä¸€æ¬¡æ‰§è¡Œgetterå¾—åˆ°çš„å€¼å³ä¸ºoldValue\r\n    // æ‰§è¡Œå®Œgetterå°±æŠŠå½“å‰watcheråˆ æ‰ï¼Œä»¥é˜²æ­¢ç”¨æˆ·åœ¨methods/ç”Ÿå‘½å‘¨æœŸä¸­è®¿é—®dataå±æ€§æ—¶è¿›è¡Œä¾èµ–æ”¶é›†ï¼ˆæ•°æ®åŠ«æŒæ—¶ä¼šåˆ¤æ–­Dep.targetæ˜¯å¦å­˜åœ¨ï¼‰\r\n    popTarget(); // åœ¨è°ƒç”¨æ–¹æ³•ä¹‹åæŠŠå½“å‰watcherå®ä¾‹ä»å…¨å±€watcheræ ˆä¸­ç§»é™¤ï¼Œè®¾ç½®Dep.targetä¸ºæ–°çš„æ ˆé¡¶watcher\r\n    return res;\r\n  }\r\n\r\n  /**\r\n   * 1. ä¿è¯depå”¯ä¸€ï¼Œå› ä¸ºåœ¨renderè¿‡ç¨‹ä¸­ï¼ŒåŒä¸€å±æ€§å¯èƒ½è¢«å¤šæ¬¡è°ƒç”¨ï¼Œåªéœ€æ”¶é›†ä¸€æ¬¡ä¾èµ–å³å¯ï¼›å¦å¤–åˆå§‹æ¸²æŸ“æ”¶é›†è¿‡çš„depï¼Œåœ¨æ›´æ–°æ—¶ä¹Ÿä¸ç”¨å†æ¬¡æ”¶é›†ï¼ˆé€šè¿‡depçš„idæ¥åˆ¤æ–­ï¼‰\r\n   * 2. å°†depæ”¾åˆ°watcherä¸­çš„depsæ•°ç»„ä¸­\r\n   * 3. åœ¨depå®ä¾‹ä¸­æ·»åŠ watcher\r\n   */\r\n  addDep(dep) {\r\n    let id = dep.id;\r\n    if (!this.depsId.has(id)) {\r\n      this.depsId.add(id);\r\n      // å°†depæ”¾åˆ°watcherä¸­çš„depsæ•°ç»„ä¸­\r\n      this.deps.push(dep);\r\n      // ç›´æ¥è°ƒç”¨depçš„addSubæ–¹æ³•  æŠŠè‡ªå·±watcherå®ä¾‹æ·»åŠ åˆ°depçš„subså®¹å™¨é‡Œé¢\r\n      dep.addSub(this);\r\n    }\r\n  }\r\n\r\n  // æ›´æ–°å½“å‰watcherç›¸å…³çš„è§†å›¾\r\n  // Vueä¸­çš„æ›´æ–°æ˜¯å¼‚æ­¥çš„\r\n  // å½“è®¡ç®—å±æ€§çš„ä¾èµ–é¡¹å‘ç”Ÿæ”¹å˜ï¼Œä¼šè§¦å‘ä¾èµ–é¡¹ç›¸å…³ watcherï¼ˆä¸€èˆ¬ä¾èµ–é¡¹ä¼šæ”¶é›†computed watcherå’Œæ¸²æŸ“watcherï¼Œæ‰€ä»¥ä¸‹é¢ifã€elseéƒ½ä¼šèµ°ï¼‰ çš„updateæ–¹æ³•\r\n  update() {\r\n    // è®¡ç®—å±æ€§çš„å€¼å‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿä¼šæ‰§è¡Œåˆ°updateï¼›\r\n    // è¿™é‡Œåšä¸ªåˆ¤æ–­ï¼Œå¦‚æœæ˜¯è®¡ç®—å±æ€§watcherï¼Œåˆ™å°†dirtyè®¾ç½®æˆtrueï¼Œä¸‹æ¬¡è®¿é—®è®¡ç®—å±æ€§æ—¶å°±ä¼šé‡æ–°è®¡ç®—ã€‚\r\n    if (this.lazy) {\r\n      this.dirty = true;\r\n      /**\r\n       * è®¡ç®—å±æ€§çš„ä¾èµ–ä¸ä»…éœ€è¦æ”¶é›†è®¡ç®—å±æ€§watcherï¼Œè¿˜åº”è¯¥æ”¶é›†æ¸²æŸ“watcherï¼Œè¿™æ ·å½“ä¾èµ–é¡¹æ”¹å˜çš„æ—¶å€™ï¼Œé¡µé¢æ‰ä¼šé‡æ–°æ¸²æŸ“\r\n       */\r\n    } else {\r\n      // æ¯æ¬¡watcherè¿›è¡Œæ›´æ–°çš„æ—¶å€™ï¼Œå¯ä»¥è®©ä»–ä»¬å…ˆç¼“å­˜èµ·æ¥ï¼Œä¹‹åå†ä¸€èµ·è°ƒç”¨\r\n      // å¼‚æ­¥é˜Ÿåˆ—æœºåˆ¶\r\n      queueWatcher(this);\r\n    }\r\n  }\r\n\r\n  // åœ¨è®¡ç®—å±æ€§çš„ä»£ç†ä¸­ï¼Œå½“dirtyä¸ºtrueæ—¶ä¼šæ‰§è¡Œevaluate\r\n  evaluate() {\r\n    this.value = this.get(); // è®¡ç®—æ–°å€¼ï¼Œå¹¶å¯¹ä¾èµ–é¡¹æ”¶é›†computed watcher\r\n    this.dirty = false;\r\n  }\r\n  depend() {\r\n    // è®¡ç®—å±æ€§çš„watcherå­˜å‚¨äº†ä¾èµ–é¡¹çš„dep\r\n    let i = this.deps.length;\r\n    while (i--) {\r\n      this.deps[i].depend(); // è°ƒç”¨ä¾èµ–é¡¹çš„depå»æ”¶é›†æ¸²æŸ“watcher\r\n    }\r\n  }\r\n\r\n  run() {\r\n    // æ‰§è¡Œgetterï¼Œæ›´æ–°è§†å›¾/è·å–æ–°å€¼\r\n    const newVal = this.getter(); // æ–°å€¼\r\n    const oldVal = this.value; //è€å€¼\r\n    this.value = newVal; // newValå°±æˆä¸ºäº†ç°åœ¨çš„å€¼ï¼›ä¸ºäº†ä¿è¯ä¸‹ä¸€æ¬¡æ›´æ–°æ—¶ï¼Œä¸Šä¸€æ¬¡çš„æ–°å€¼æ˜¯ä¸‹ä¸€æ¬¡çš„è€å€¼\r\n\r\n    // å¦‚æœæ˜¯ç”¨æˆ·watcher\r\n    if (this.user) {\r\n      if (newVal !== oldVal || isObject(newVal)) {\r\n        this.cb.call(this.vm, newVal, oldVal);\r\n      }\r\n    } else {\r\n      // æ¸²æŸ“watcher\r\n      this.cb.call(this.vm);\r\n    }\r\n  }\r\n}\r\n","/**\r\n * æ•°æ®åˆå§‹åŒ–ï¼šinitPropsã€initMethodã€initDataã€initComputedã€initWatch\r\n */\r\n\r\nimport { observe } from \"./observer/index\";\r\nimport { isFunction } from \"./util/index\";\r\nimport Watcher from \"./observer/watcher\";\r\nimport Dep from \"./observer/dep.js\";\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options;\r\n  if (opts.props) {\r\n    initProps(vm);\r\n  }\r\n  if (opts.methods) {\r\n    initMethod(vm);\r\n  }\r\n  // åˆå§‹åŒ–data\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n  // åˆå§‹åŒ–computed\r\n  if (opts.computed) {\r\n    initComputed(vm);\r\n  }\r\n  // åˆå§‹åŒ–watch\r\n  if (opts.watch) {\r\n    initWatch(vm);\r\n  }\r\n}\r\n\r\nfunction initProps() {}\r\nfunction initMethod() {}\r\n\r\n// åˆå§‹åŒ–data\r\nfunction initData(vm) {\r\n  let data = vm.$options.data;\r\n  // å¾€å®ä¾‹ä¸Šæ·»åŠ ä¸€ä¸ªå±æ€§ _dataï¼Œå³ä¼ å…¥çš„data\r\n  // vueç»„ä»¶dataæ¨èä½¿ç”¨å‡½æ•° é˜²æ­¢æ•°æ®åœ¨ç»„ä»¶ä¹‹é—´å…±äº«\r\n  data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n\r\n  // å°†vm._dataä¸Šçš„æ‰€æœ‰å±æ€§ä»£ç†åˆ° vm ä¸Š\r\n  for (let key in data) {\r\n    proxy(vm, \"_data\", key);\r\n  }\r\n  // å¯¹æ•°æ®è¿›è¡Œè§‚æµ‹ -- æ•°æ®å“åº”å¼\r\n  observe(data);\r\n}\r\n\r\n// åˆå§‹åŒ–computed\r\nfunction initComputed(vm) {\r\n  const computed = vm.$options.computed;\r\n  const watchers = vm._computedWatchers = {}; // ç”¨watcherså’Œvm._computedWatchers ç”¨æ¥å­˜æ”¾è®¡ç®—watcher\r\n\r\n  for (let k in computed) {\r\n    const userDef = computed[k]; // è·å–ç”¨æˆ·å®šä¹‰çš„è®¡ç®—å±æ€§ï¼›å¯èƒ½æ˜¯å‡½æ•°ã€‚ä¹Ÿå¯èƒ½æ˜¯å¯¹è±¡ï¼ˆå†…éƒ¨æœ‰getã€setå‡½æ•°ï¼‰\r\n    // è·å–computedçš„getter\r\n    let getter = typeof userDef === \"function\" ? userDef : userDef.get;\r\n\r\n    // æ¯ä¸ªè®¡ç®—å±æ€§æœ¬è´¨å°±æ˜¯watcher\r\n    // æœ‰å¤šå°‘ä¸ªgetterï¼Œå°±åˆ›å»ºå¤šå°‘ä¸ªwatcher\r\n    // åˆ›å»ºè®¡ç®—watcherï¼Œlazyè®¾ç½®ä¸ºtrue\r\n    watchers[k] = new Watcher(vm, getter, () => {}, { lazy: true });\r\n    // å°†computedä¸­çš„å±æ€§ç›´æ¥ä»£ç†åˆ°vmä¸‹\r\n    defineComputed(vm, k, userDef);\r\n  }\r\n}\r\n\r\n/**\r\n * 1. å°†computedä¸­çš„å±æ€§ç›´æ¥ä»£ç†åˆ°vmä¸Š\r\n * 2. å°†ä»£ç†çš„getè¿›è¡ŒåŒ…è£¹ï¼ˆå³è¿›è¡Œç¼“å­˜å¤„ç†ï¼Œä¸ç”¨æ¯æ¬¡è·å–computedéƒ½è¿›è¡Œé‡æ–°è®¡ç®—ï¼‰\r\n */\r\nconst sharedPropertyDefinition = {\r\n  enumerable: true,\r\n  configurable: true,\r\n  get: () => {},\r\n  set: () => {},\r\n};\r\nfunction defineComputed(vm, key, userDef) {\r\n  if (typeof userDef === \"function\") {    \r\n    sharedPropertyDefinition.get = createComputedGetter(key);\r\n  } else {\r\n    sharedPropertyDefinition.get = createComputedGetter(key);\r\n    sharedPropertyDefinition.set = userDef.set;\r\n  }\r\n  Object.defineProperty(vm, key, sharedPropertyDefinition);\r\n}\r\n// å–è®¡ç®—å±æ€§çš„å€¼ï¼Œèµ°è¿™ä¸ªå‡½æ•°\r\nfunction createComputedGetter(key) {\r\n  return function () {\r\n    const watcher = this._computedWatchers[key];\r\n    if(watcher) {\r\n      // æ ¹æ®dirtyå±æ€§ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°è®¡ç®—ï¼ˆè„å°±æ˜¯è¦è°ƒç”¨getterï¼Œä¸è„å°±æ˜¯ç›´æ¥å–watcher.valueï¼‰\r\n      if (watcher.dirty) {\r\n        watcher.evaluate(); // è®¡ç®—å±æ€§å–å€¼çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯è„çš„ï¼Œéœ€è¦é‡æ–°æ±‚å€¼ï¼›ä¾èµ–çš„å‚æ•°ä¼šæ”¶é›†è®¡ç®—å±æ€§watcherï¼›\r\n\r\n        /**\r\n         * è®¡ç®—å±æ€§çš„ä¾èµ–ä¸ä»…éœ€è¦æ”¶é›†è®¡ç®—å±æ€§watcherï¼Œè¿˜åº”è¯¥æ”¶é›†æ¸²æŸ“watcherï¼Œè¿™æ ·å½“ä¾èµ–é¡¹æ”¹å˜çš„æ—¶å€™ï¼Œé¡µé¢æ‰ä¼šé‡æ–°æ¸²æŸ“ï¼›\r\n         * åœ¨æ‰§è¡ŒmountComponentæ—¶ï¼Œä¼šå…ˆè®¾ç½®Dep.targetç­‰äºæ¸²æŸ“watcherï¼Œç„¶åå°†å®ƒpushåˆ°targetStackä¸­\r\n         * å½“è§£æåˆ°è®¡ç®—å±æ€§æ—¶ï¼Œå°†Dep.targetè®¾ç½®æˆè®¡ç®—å±æ€§watcherï¼ŒpushTarget()ï¼Œä¾èµ–é¡¹æ”¶é›†å½“å‰è®¡ç®—å±æ€§watcherï¼Œç„¶åpopTarget()ï¼Œç„¶åä¾èµ–é¡¹æ”¶é›†å½“å‰æ¸²æŸ“watcher\r\n         * å¯¹æ‰€æœ‰è®¡ç®—å±æ€§å¾ªç¯æ­¤æ“ä½œ\r\n         * å°†æ¸²æŸ“watcher  popTarget()\r\n         */\r\n        // å¦‚æœDepè¿˜å­˜åœ¨targetï¼Œè¿™ä¸ªæ—¶å€™ä¸€èˆ¬ä¸ºæ¸²æŸ“watcherï¼Œè®¡ç®—å±æ€§ä¾èµ–çš„æ•°æ®éœ€è¦ç»§ç»­æ”¶é›†æ¸²æŸ“watcher\r\n        if (Dep.target) {\r\n          watcher.depend()\r\n        }\r\n      }\r\n      return watcher.value;\r\n    }\r\n  };\r\n}\r\n\r\n// åˆå§‹åŒ–watch\r\nfunction initWatch(vm) {\r\n  let watch = vm.$options.watch;\r\n  for (let k in watch) {\r\n    const handler = watch[k]; // å¯èƒ½æ˜¯æ•°ç»„ã€å¯¹è±¡ã€å‡½æ•°ã€å­—ç¬¦ä¸²ï¼Œwatchæ”¯æŒå¤šç§å†™æ³•\r\n    if (Array.isArray(handler)) {\r\n      handler.forEach((handle) => {\r\n        createWatcher(vm, k, handle);\r\n      });\r\n    } else {\r\n      createWatcher(vm, k, handler);\r\n    }\r\n  }\r\n}\r\n\r\nfunction createWatcher(vm, key, handler, options = {}) {\r\n  if (typeof handler === \"object\") {\r\n    options = handler; //ä¿å­˜ç”¨æˆ·ä¼ å…¥çš„å¯¹è±¡\r\n    handler = handler.handler; //æ˜¯å‡½æ•°\r\n  }\r\n  if (typeof handler === \"string\") {\r\n    handler = vm[handler];\r\n  }\r\n  // watchç›¸å½“äºè°ƒç”¨äº† vm.$watch()\r\n  return vm.$watch(key, handler, options);\r\n}\r\n\r\n// å°†vm._dataä¸Šçš„å±æ€§ä»£ç†åˆ° vm ä¸Š\r\nfunction proxy(vm, source, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[source][key];\r\n    },\r\n    set(newValue) {\r\n      vm[source][key] = newValue;\r\n    },\r\n  });\r\n}\r\n\r\nexport function stateMixin(Vue) {\r\n  Vue.prototype.$watch = function (exprOrFn, cb, options) {\r\n    const vm = this;\r\n    // è¿™é‡Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªç”¨æˆ·watcher\r\n    let watcher = new Watcher(vm, exprOrFn, cb, { ...options, user: true }); // user: trueè¡¨ç¤ºè¯¥watcherä¸ºç”¨æˆ·è‡ªå·±åˆ›å»ºåœ°watcher\r\n    if (options.immediate) {\r\n      cb(watcher.value); // å¦‚æœç«‹åˆ»æ‰§è¡Œ\r\n    }\r\n  };\r\n}\r\n","// ä»¥ä¸‹ä¸ºvueæºç çš„æ­£åˆ™\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //åŒ¹é…æ ‡ç­¾åï¼›å½¢å¦‚ abc-123\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //åŒ¹é…ç‰¹æ®Šæ ‡ç­¾;å½¢å¦‚ abc:234,å‰é¢çš„abc:å¯æœ‰å¯æ— ï¼›è·å–æ ‡ç­¾åï¼›\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // åŒ¹é…æ ‡ç­¾å¼€å¤´ï¼›å½¢å¦‚  <  ï¼›æ•è·é‡Œé¢çš„æ ‡ç­¾å\r\nconst startTagClose = /^\\s*(\\/?)>/; // åŒ¹é…æ ‡ç­¾ç»“å°¾ï¼Œå½¢å¦‚ >ã€/>\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // åŒ¹é…ç»“æŸæ ‡ç­¾ å¦‚ </abc-123> æ•è·é‡Œé¢çš„æ ‡ç­¾å\r\nconst attribute =\r\n  /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // åŒ¹é…å±æ€§  å½¢å¦‚ id=\"app\"\r\n\r\nexport function parse(template) {\r\n  /**\r\n   * handleStartTagã€handleEndTagã€handleCharså°†åˆå§‹è§£æçš„ç»“æœï¼Œç»„è£…æˆä¸€ä¸ªæ ‘ç»“æ„ã€‚\r\n   * ä½¿ç”¨æ ˆç»“æ„æ„å»ºASTæ ‘\r\n   */\r\n  let root; // æ ¹èŠ‚ç‚¹\r\n  let currentParent; // ä¸‹ä¸€ä¸ªå­å…ƒç´ çš„çˆ¶å…ƒç´ \r\n  let stack = []; // æ ˆç»“æ„ï¼›æ ˆä¸­push/popå…ƒç´ èŠ‚ç‚¹ï¼Œå¯¹äºæ–‡æœ¬èŠ‚ç‚¹ï¼Œç›´æ¥pushåˆ°currentParent.childrenå³å¯ï¼Œä¸ç”¨pushåˆ°æ ˆä¸­\r\n  // è¡¨ç¤ºå…ƒç´ å’Œæ–‡æœ¬çš„type\r\n  const ELEMENT_TYPE = 1;\r\n  const TEXT_TYPE = 3;\r\n  // åˆ›å»ºASTèŠ‚ç‚¹\r\n  function createASTElement(tagName, attrs) {\r\n    return {\r\n      tag: tagName,\r\n      type: ELEMENT_TYPE,\r\n      children: [],\r\n      attrs,\r\n      parent: null,\r\n    };\r\n  }\r\n  // å¯¹å¼€å§‹æ ‡ç­¾è¿›è¡Œå¤„ç†\r\n  function handleStartTag({ tagName, attrs }) {\r\n    let element = createASTElement(tagName, attrs);\r\n    // å¦‚æœæ²¡æœ‰æ ¹å…ƒç´ ï¼Œåˆ™å½“å‰å…ƒç´ å³ä¸ºæ ¹å…ƒç´ \r\n    if (!root) {\r\n      root = element;\r\n    }\r\n    currentParent = element;\r\n    // å°†å…ƒç´ æ”¾å…¥æ ˆä¸­\r\n    stack.push(element);\r\n  }\r\n  // å¯¹ç»“æŸæ ‡ç­¾è¿›è¡Œå¤„ç†\r\n  function handleEndTag(tagName) {\r\n    // å¤„ç†åˆ°ç»“æŸæ ‡ç­¾æ—¶ï¼Œå°†è¯¥å…ƒç´ ä»æ ˆä¸­ç§»å‡º\r\n    let element = stack.pop();\r\n    // currentParentæ­¤æ—¶ä¸ºelementçš„ä¸Šä¸€ä¸ªå…ƒç´ \r\n    currentParent = stack[stack.length - 1];\r\n    // å»ºç«‹parentå’Œchildrenå…³ç³»\r\n    if (currentParent) {\r\n      element.parent = currentParent;\r\n      currentParent.children.push(element);\r\n    }\r\n  }\r\n  // å¯¹æ–‡æœ¬è¿›è¡Œå¤„ç†\r\n  function handleChars(text) {\r\n    // å»æ‰ç©ºæ ¼\r\n    text = text.replace(/\\s/g, \"\");\r\n    if (text) {\r\n      currentParent.children.push({\r\n        type: TEXT_TYPE,\r\n        text,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * é€’å½’è§£ætemplateï¼Œè¿›è¡Œåˆæ­¥å¤„ç†\r\n   * è§£æå¼€å§‹æ ‡ç­¾ï¼Œå°†ç»“æœ{tagName, attrs} äº¤ç»™ handleStartTag å¤„ç†\r\n   * è§£æç»“æŸæ ‡ç­¾ï¼Œå°†ç»“æœ tagName äº¤ç»™ handleEndTag å¤„ç†\r\n   * è§£ææ–‡æœ¬é—¨å°†ç»“æœ text äº¤ç»™ handleChars å¤„ç†\r\n   */\r\n  while (template) {\r\n    // æŸ¥æ‰¾ < çš„ä½ç½®ï¼Œæ ¹æ®å®ƒçš„ä½ç½®åˆ¤æ–­ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä»€ä¹ˆæ ‡ç­¾\r\n    let textEnd = template.indexOf(\"<\");\r\n\r\n    // å½“ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º '<' æ—¶ï¼Œå³ç¢°åˆ°å¼€å§‹æ ‡ç­¾/ç»“æŸæ ‡ç­¾æ—¶\r\n    if (textEnd === 0) {\r\n      // åŒ¹é…å¼€å§‹æ ‡ç­¾<div> æˆ– <image/>\r\n      const startTagMatch = parseStartTag();\r\n      if (startTagMatch) {\r\n        handleStartTag(startTagMatch);\r\n        continue; // continue è¡¨ç¤ºè·³å‡ºæœ¬æ¬¡å¾ªç¯ï¼Œè¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯\r\n      }\r\n\r\n      // åŒ¹é…ç»“æŸæ ‡ç­¾</div>\r\n      const endTagMatch = template.match(endTag);\r\n      if (endTagMatch) {\r\n        // endTagMatchå¦‚æœåŒ¹é…æˆåŠŸï¼Œå…¶æ ¼å¼ä¸ºæ•°ç»„ï¼š['</div>', 'div']\r\n        advance(endTagMatch[0].length);\r\n        handleEndTag(endTagMatch[1]);\r\n        continue;\r\n      }\r\n    }\r\n\r\n    // å½“ç¬¬ä¸€ä¸ªå…ƒç´ ä¸æ˜¯'<'ï¼Œå³ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ–‡æœ¬æ—¶\r\n    let text;\r\n    if (textEnd >= 0) {\r\n      // è·å–æ–‡æœ¬\r\n      text = template.substring(0, textEnd);\r\n    }\r\n    if (text) {\r\n      advance(text.length);\r\n      handleChars(text);\r\n    }\r\n  }\r\n\r\n  // è§£æå¼€å§‹æ ‡ç­¾\r\n  function parseStartTag() {\r\n    // 1. åŒ¹é…å¼€å§‹æ ‡ç­¾\r\n    const start = template.match(startTagOpen);\r\n    // startæ ¼å¼ä¸ºæ•°ç»„ï¼Œå½¢å¦‚ ['<div', 'div']ï¼›ç¬¬äºŒé¡¹ä¸ºæ ‡ç­¾å\r\n    if (start) {\r\n      const match = {\r\n        tagName: start[1],\r\n        attrs: [],\r\n      };\r\n\r\n      //åŒ¹é…åˆ°äº†å¼€å§‹æ ‡ç­¾ï¼Œå°±æŠŠ <tagname æˆªå–æ‰ï¼Œå¾€åç»§ç»­åŒ¹é…å±æ€§\r\n      advance(start[0].length);\r\n\r\n      // 2. å¼€å§‹é€’å½’åŒ¹é…æ ‡ç­¾å±æ€§\r\n      // endä»£è¡¨ç»“æŸç¬¦å· > ï¼›å¦‚æœåŒ¹é…æˆåŠŸï¼Œæ ¼å¼ä¸ºï¼š['>', '']\r\n      // attr è¡¨ç¤ºåŒ¹é…çš„å±æ€§\r\n      let end, attr;\r\n      // ä¸æ˜¯æ ‡ç­¾ç»“å°¾ï¼Œå¹¶ä¸”èƒ½åŒ¹é…åˆ°å±æ€§æ—¶\r\n      while (\r\n        !(end = template.match(startTagClose)) &&\r\n        (attr = template.match(attribute))\r\n      ) {\r\n        // attrå¦‚æœåŒ¹é…æˆåŠŸï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ ¼å¼ä¸ºï¼š[\"class=\\\"myClass\\\"\", \"class\", \"=\", \"myClass\", undefined, undefined]\r\n        // attr[1]ä¸ºå±æ€§åï¼Œattr[3]/attr[4]/attr[5]ä¸ºå±æ€§å€¼ï¼Œå–å†³äºå±æ€§å®šä¹‰æ˜¯åŒå¼•å·/å•å¼•å·/æ— å¼•å·\r\n\r\n        // åŒ¹é…æˆåŠŸä¸€ä¸ªå±æ€§ï¼Œå°±åœ¨templateä¸Šæˆªå–æ‰è¯¥å±æ€§ï¼Œç»§ç»­å¾€ååŒ¹é…\r\n        advance(attr[0].length);\r\n        attr = {\r\n          name: attr[1],\r\n          value: attr[3] || attr[4] || attr[5], //è¿™é‡Œæ˜¯å› ä¸ºæ­£åˆ™æ•è·æ”¯æŒåŒå¼•å·ï¼ˆï¼‰ å•å¼•å· å’Œæ— å¼•å·çš„å±æ€§å€¼\r\n        };\r\n        match.attrs.push(attr);\r\n      }\r\n\r\n      // 3. åŒ¹é…åˆ°å¼€å§‹æ ‡ç­¾ç»“å°¾\r\n      if (end) {\r\n        //   ä»£è¡¨ä¸€ä¸ªæ ‡ç­¾åŒ¹é…åˆ°ç»“æŸçš„>äº† ä»£è¡¨å¼€å§‹æ ‡ç­¾è§£æå®Œæ¯•\r\n        advance(1);\r\n        return match;\r\n      }\r\n    }\r\n  }\r\n\r\n  // æˆªå–templateå­—ç¬¦ä¸² æ¯æ¬¡åŒ¹é…åˆ°äº†å°±ã€å¾€å‰ç»§ç»­åŒ¹é…ã€‘\r\n  function advance(n) {\r\n    template = template.substring(n);\r\n  }\r\n\r\n  // è¿”å›ç”Ÿæˆçš„astï¼›rootåŒ…å«æ•´ä¸ªæ ‘çŠ¶ç»“æ„ä¿¡æ¯\r\n  return root;\r\n}\r\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // åŒ¹é…èŠ±æ‹¬å· {{  }}ï¼›æ•è·èŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹\r\nfunction gen(node) {\r\n  // å¦‚æœæ˜¯å…ƒç´ ç±»å‹\r\n  if (node.type == 1) {\r\n    // ã€å…³é”®ã€‘é€’å½’åˆ›å»º\r\n    return generate(node);\r\n  } else {\r\n    // elseå³æ–‡æœ¬ç±»å‹\r\n    let text = node.text;\r\n\r\n    // 1. å¦‚æœtextä¸­ä¸å­˜åœ¨èŠ±æ‹¬å·å˜é‡è¡¨è¾¾å¼\r\n    if (!defaultTagRE.test(text)) {\r\n      // _vè¡¨ç¤ºåˆ›å»ºæ–‡æœ¬\r\n      return `_v(${JSON.stringify(text)})`;\r\n    }\r\n\r\n    // æ­£åˆ™æ˜¯å…¨å±€æ¨¡å¼ æ¯æ¬¡éœ€è¦é‡ç½®æ­£åˆ™çš„lastIndexå±æ€§ï¼Œä¸ç„¶ä¼šå¼•å‘åŒ¹é…bugï¼ˆdefaultTagRE.exec()åŒ¹é…å®Œä¸€æ¬¡åï¼Œå†æ¬¡åŒ¹é…ä¸ºnullï¼Œéœ€è¦é‡ç½®lastIndexï¼‰\r\n    let lastIndex = (defaultTagRE.lastIndex = 0);\r\n    let tokens = [];\r\n    let match, index;\r\n\r\n    // 2. å¦‚æœtextä¸­å­˜åœ¨èŠ±æ‹¬å·å˜é‡ï¼ˆä½¿ç”¨whileå¾ªç¯ï¼Œæ˜¯å› ä¸ºå¯èƒ½å­˜åœ¨å¤šä¸ª{{å˜é‡}}ï¼‰\r\n    while ((match = defaultTagRE.exec(text))) {\r\n      // matchå¦‚æœåŒ¹é…æˆåŠŸï¼Œå…¶ç»“æ„ä¸ºï¼š['{{myValue}}', 'myValue', index: indexof({) ]\r\n      // indexä»£è¡¨åŒ¹é…åˆ°çš„ä½ç½®\r\n      index = match.index;\r\n      // åˆå§‹ lastIndex ä¸º0ï¼Œindex > lastIndex è¡¨ç¤ºåœ¨{{ å‰æœ‰æ™®é€šæ–‡æœ¬\r\n      if (index > lastIndex) {\r\n        // åœ¨tokensé‡Œé¢æ”¾å…¥ {{ ä¹‹å‰çš„æ™®é€šæ–‡æœ¬\r\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)));\r\n      }\r\n      // tokensä¸­æ”¾å…¥æ•è·åˆ°çš„å˜é‡å†…å®¹\r\n      tokens.push(`_s(${match[1].trim()})`);\r\n      // åŒ¹é…æŒ‡é’ˆåç§»ï¼Œç§»åˆ° }} åé¢\r\n      lastIndex = index + match[0].length;\r\n    }\r\n\r\n    // 3. å¦‚æœåŒ¹é…å®Œäº†èŠ±æ‹¬å·ï¼Œtexté‡Œé¢è¿˜æœ‰å‰©ä½™çš„æ™®é€šæ–‡æœ¬ï¼Œé‚£ä¹ˆç»§ç»­push\r\n    if (lastIndex < text.length) {\r\n      tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n    }\r\n    // _vè¡¨ç¤ºåˆ›å»ºæ–‡æœ¬\r\n    return `_v(${tokens.join(\"+\")})`;\r\n  }\r\n}\r\n\r\n// ç”Ÿæˆå­èŠ‚ç‚¹ï¼šéå†childrenè°ƒç”¨gen(item)ï¼Œä½¿ç”¨é€—å·æ‹¼æ¥æ¯ä¸€é¡¹çš„ç»“æœ\r\nfunction getChildren(el) {\r\n  const children = el.children;\r\n  if (children) {\r\n    return `${children.map((c) => gen(c)).join(\",\")}`;\r\n  }\r\n}\r\n\r\n// å¤„ç†attrs/propså±æ€§ï¼šå°†[{name: 'class', value: 'home'}, {name: 'style', value: \"font-size:12px;color:red\"}]\r\n//                  è½¬åŒ–æˆ \"class:\"home\",style:{\"font-size\":\"12px\",\"color\":\"red\"}\"\r\nfunction genProps(attrs) {\r\n  let str = \"\";\r\n  for (let i = 0; i < attrs.length; i++) {\r\n    let attr = attrs[i];\r\n    // å¯¹attrså±æ€§é‡Œé¢çš„styleåšç‰¹æ®Šå¤„ç†\r\n    if (attr.name === \"style\") {\r\n      let obj = {};\r\n      attr.value.split(\";\").forEach((item) => {\r\n        let [key, value] = item.split(\":\");\r\n        obj[key] = value;\r\n      });\r\n      attr.value = obj;\r\n    }\r\n    str += `${attr.name}:${JSON.stringify(attr.value)},`;\r\n  }\r\n  return `{${str.slice(0, -1)}}`;\r\n}\r\n\r\n// å°†astè½¬åŒ–æˆrenderå‡½æ•°\r\nexport function generate(ast) {\r\n  let children = getChildren(ast);\r\n\r\n  let code = `_c('${ast.tag}',${\r\n    ast.attrs.length ? `${genProps(ast.attrs)}` : \"undefined\"\r\n  }${children ? `,${children}` : \"\"})`;\r\n\r\n  return code;\r\n}\r\n","import { parse } from \"./parse\";\r\nimport { generate } from \"./codegen\";\r\nexport function compileToFunctions(template) {\r\n  // 1. æŠŠtemplateè½¬æˆASTè¯­æ³•æ ‘ï¼›ASTç”¨æ¥æè¿°ä»£ç æœ¬èº«å½¢æˆæ ‘ç»“æ„ï¼Œä¸ä»…å¯ä»¥æè¿°htmlï¼Œä¹Ÿèƒ½æè¿°cssä»¥åŠjsè¯­æ³•\r\n  let ast = parse(template);\r\n  console.log(\"ğŸš€AST-----\", ast);\r\n  // 2. ä¼˜åŒ–é™æ€èŠ‚ç‚¹\r\n  // è¿™ä¸ªæœ‰å…´è¶£çš„å¯ä»¥å»çœ‹æºç   ä¸å½±å“æ ¸å¿ƒåŠŸèƒ½å°±ä¸å®ç°äº†\r\n  //   if (options.optimize !== false) {\r\n  //     optimize(ast, options);\r\n  //   }\r\n\r\n  // 3. é€šè¿‡astï¼Œé‡æ–°ç”Ÿæˆä»£ç \r\n  // æˆ‘ä»¬æœ€åç”Ÿæˆçš„ä»£ç éœ€è¦å’Œrenderå‡½æ•°ä¸€æ ·\r\n  // ç±»ä¼¼_c('div',{id:\"app\"},_c('div',undefined,_v(\"hello\"+_s(name)),_c('span',undefined,_v(\"world\"))))\r\n  // _cä»£è¡¨åˆ›å»ºå…ƒç´  _vä»£è¡¨åˆ›å»ºæ–‡æœ¬ _sä»£è¡¨æ–‡Json.stringify--æŠŠå¯¹è±¡è§£ææˆæ–‡æœ¬\r\n  let code = generate(ast);\r\n  console.log(\"ğŸš€renderFunction-----\", code);\r\n  \r\n  // é€šè¿‡new Functionç”Ÿæˆå‡½æ•°\r\n  let renderFn = new Function(`with(this){return ${code}}`);\r\n  return renderFn;\r\n}\r\n","export function patch(oldVnode, vnode) {\r\n  // ç¬¬ä¸€æ¬¡æ¸²æŸ“ç»„ä»¶å…ƒç´ æ—¶ï¼›æ²¡æœ‰$elï¼Œä¹Ÿæ²¡æœ‰oldVnode\r\n  if (!oldVnode) {\r\n    // ç»„ä»¶çš„åˆ›å»ºè¿‡ç¨‹æ˜¯æ²¡æœ‰elå±æ€§çš„\r\n    return createElm(vnode);\r\n  } else {\r\n    // Vnodeæ²¡æœ‰è®¾ç½®nodeTypeï¼Œå€¼ä¸ºundefinedï¼›çœŸå®èŠ‚ç‚¹å¯ä»¥è·å–åˆ°nodeType\r\n    const isRealElement = oldVnode.nodeType;\r\n    // å¦‚æœæ˜¯åˆæ¬¡æ¸²æŸ“\r\n    if (isRealElement) {\r\n      const oldElm = oldVnode;\r\n      const parentElm = oldElm.parentNode;\r\n      // å°†è™šæ‹Ÿdomè½¬åŒ–æˆçœŸå®domèŠ‚ç‚¹\r\n      const el = createElm(vnode);\r\n\r\n      // æ’å…¥åˆ° è€çš„elèŠ‚ç‚¹ çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„å‰é¢ï¼Œå°±ç›¸å½“äºæ’å…¥åˆ°è€çš„elèŠ‚ç‚¹çš„åé¢\r\n      // è¿™é‡Œä¸ç›´æ¥ä½¿ç”¨çˆ¶å…ƒç´ appendChildæ˜¯ä¸ºäº†ä¸ç ´åæ›¿æ¢çš„ä½ç½®\r\n      parentElm.insertBefore(el, oldElm.nextSibling);\r\n\r\n      // åˆ é™¤è€çš„elèŠ‚ç‚¹\r\n      parentElm.removeChild(oldVnode);\r\n      return el;\r\n    } else {\r\n      /**\r\n       * å¦‚æœæ˜¯æ›´æ–°è§†å›¾\r\n       */\r\n      // 1. å¦‚æœæ ‡ç­¾åä¸ä¸€æ ·ï¼Œç›´æ¥åˆ æ‰è€çš„ï¼Œæ¢æˆæ–°çš„\r\n      // debugger;\r\n      if (oldVnode.tag !== vnode.tag) {\r\n        // vnode.elå°±æ˜¯åœ¨ createElm(vnode)åˆ›å»ºçœŸå®domæ—¶æ·»åŠ åˆ°vnodeä¸Šçš„ï¼Œvnode.elæ˜¯çœŸå®dom\r\n        oldVnode.el.parentNode.replaceChild(createElm(vnode), oldVnode.el); // oldVnode.elä»£è¡¨çš„æ˜¯çœŸå®domèŠ‚ç‚¹\r\n      }\r\n      // 2. å¦‚æœæ–°æ—§èŠ‚ç‚¹æ˜¯ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ï¼ˆæ–°èŠ‚ç‚¹æ˜¯ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ï¼Œåˆ™æ—§èŠ‚ç‚¹ä¸€å®šæ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œå¦åˆ™ä¸¤è€…tagä¸åŒï¼Œä¼šèµ°ä¸Šé¢çš„åˆ¤æ–­ï¼‰\r\n      if (!vnode.tag) {\r\n        if (oldVnode.text !== vnode.text) {\r\n          oldVnode.el.textContent = vnode.text;\r\n        }\r\n      }\r\n      // 3. ä¸ç¬¦åˆä¸Šé¢ä¸¤ç§ï¼Œä»£è¡¨æ ‡ç­¾åä¸€è‡´ï¼Œå¹¶ä¸”ä¸æ˜¯æ–‡æœ¬èŠ‚ç‚¹\r\n      const el = (vnode.el = oldVnode.el); // ä¸ºäº†èŠ‚ç‚¹å¤ç”¨ æ‰€ä»¥ç›´æ¥æŠŠæ—§çš„è™šæ‹Ÿdomå¯¹åº”çš„çœŸå®domèµ‹å€¼ç»™æ–°çš„è™šæ‹Ÿdomçš„elå±æ€§\r\n      updateProperties(vnode, oldVnode.data); // æ›´æ–°å±æ€§\r\n      const oldCh = oldVnode.children || []; // è€çš„å„¿å­\r\n      const newCh = vnode.children || []; // æ–°çš„å„¿å­\r\n      if (oldCh.length > 0 && newCh.length > 0) {\r\n        // 3.1. æ–°è€éƒ½å­˜åœ¨å­èŠ‚ç‚¹\r\n        updateChildren(el, oldCh, newCh); // ã€æ ¸å¿ƒç®—æ³•ã€‘\r\n      } else if (oldCh.length) {\r\n        // 3.2 è€çš„æœ‰å„¿å­ï¼Œæ–°çš„æ²¡æœ‰\r\n        el.innerHTML = \"\";\r\n      } else if (newCh.length) {\r\n        // 3.3 æ–°çš„æœ‰å„¿å­ï¼Œè€çš„æ²¡å„¿å­\r\n        for (let i = 0; i < newCh.length; i++) {\r\n          const child = newCh[i];\r\n          el.appendChild(createElm(child));\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// è™šæ‹Ÿdomè½¬æˆçœŸå®dom\r\nfunction createElm(vnode) {\r\n  const { tag, data, key, children, text } = vnode;\r\n  // åˆ¤æ–­è™šæ‹Ÿdom æ˜¯å…ƒç´ èŠ‚ç‚¹ã€è‡ªå®šä¹‰ç»„ä»¶ è¿˜æ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼ˆæ–‡æœ¬èŠ‚ç‚¹tagä¸ºundefinedï¼‰\r\n  if (typeof tag === \"string\") {\r\n    // å¦‚æœæ˜¯ç»„ä»¶ï¼Œè¿”å›ç»„ä»¶æ¸²æŸ“çš„çœŸå®dom\r\n    if (createComponent(vnode)) {\r\n      return vnode.componentInstance.$el;\r\n    }\r\n\r\n    // å¦åˆ™æ˜¯å…ƒç´ \r\n    // è™šæ‹Ÿdomçš„elå±æ€§æŒ‡å‘çœŸå®domï¼Œæ–¹ä¾¿åç»­æ›´æ–°diffç®—æ³•æ“ä½œ\r\n    vnode.el = document.createElement(tag);\r\n    // è§£ævnodeå±æ€§\r\n    updateProperties(vnode);\r\n    // å¦‚æœæœ‰å­èŠ‚ç‚¹å°±é€’å½’æ’å…¥åˆ°çˆ¶èŠ‚ç‚¹é‡Œé¢\r\n    children.forEach((child) => {\r\n      return vnode.el.appendChild(createElm(child));\r\n    });\r\n  } else {\r\n    // å¦åˆ™æ˜¯æ–‡æœ¬èŠ‚ç‚¹\r\n    vnode.el = document.createTextNode(text);\r\n  }\r\n  return vnode.el;\r\n}\r\n\r\n// åˆ›å»ºç»„ä»¶çš„çœŸå®dom\r\nfunction createComponent(vnode) {\r\n  // åˆå§‹åŒ–ç»„ä»¶ï¼Œåˆ›å»ºç»„ä»¶å®ä¾‹\r\n  let i = vnode.data;\r\n  // ç›¸å½“äºæ‰§è¡Œ vnode.data.hook.init(vnode)\r\n  if ((i = i.hook) && (i = i.init)) {\r\n    i(vnode);\r\n  }\r\n  // å¦‚æœç»„ä»¶å®ä¾‹åŒ–å®Œæ¯•ï¼Œæœ‰componentInstanceå±æ€§ï¼Œé‚£è¯æ˜æ˜¯ç»„ä»¶\r\n  if (vnode.componentInstance) {\r\n    vnode.el = vnode.componentInstance.$el; // ã€å…³é”®ã€‘\r\n    return true;\r\n  }\r\n}\r\n\r\n// è§£ævnodeçš„dataå±æ€§ï¼Œæ˜ å°„åˆ°çœŸå®domä¸Š\r\n// åˆæ¬¡è°ƒç”¨æ—¶oldPropsä¸ºç©ºï¼Œæ›´æ–°æ—¶oldPropså¯èƒ½æœ‰å€¼ï¼Œéƒ½å¯ä»¥è°ƒç”¨æ­¤æ–¹æ³•æ¥è§£ævnodeçš„å±æ€§\r\nfunction updateProperties(vnode, oldProps = {}) {\r\n  let newProps = vnode.data || {};\r\n  let el = vnode.el; // çœŸå®èŠ‚ç‚¹\r\n\r\n  // å¦‚æœæ–°çš„èŠ‚ç‚¹æ²¡æœ‰è¯¥å±æ€§ï¼Œéœ€è¦æŠŠè€çš„èŠ‚ç‚¹å±æ€§ç§»é™¤\r\n  for (let k in oldProps) {\r\n    if (!newProps[k]) {\r\n      el.removeAttribute(k);\r\n    }\r\n  }\r\n\r\n  // å¯¹styleæ ·å¼åšç‰¹æ®Šå¤„ç†ï¼Œå¦‚æœæ–°çš„æ²¡æœ‰ï¼Œéœ€è¦æŠŠè€çš„styleå€¼ç½®ä¸ºç©º\r\n  let newStyle = newProps.style || {};\r\n  let oldStyle = oldProps.style || {};\r\n  for (let key in oldStyle) {\r\n    if (!newStyle[key]) {\r\n      el.style[key] = \"\";\r\n    }\r\n  }\r\n\r\n  // éå†æ–°çš„å±æ€§ï¼Œè¿›è¡Œå¢åŠ æ“ä½œ\r\n  for (const key in newProps) {\r\n    if (key === \"style\") {\r\n      for (const styleName in newProps.style) {\r\n        el.style[styleName] = newProps.style[styleName];\r\n      }\r\n    } else if (key === \"class\") {\r\n      el.className = newProps.class;\r\n    } else {\r\n      // ç»™è¿™ä¸ªå…ƒç´ æ·»åŠ å±æ€§ å€¼å°±æ˜¯å¯¹åº”çš„å€¼\r\n      el.setAttribute(key, newProps[key]);\r\n    }\r\n  }\r\n}\r\n\r\n// åˆ¤æ–­ä¸¤ä¸ªvnodeçš„æ ‡ç­¾å’Œkeyæ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯åŒä¸€èŠ‚ç‚¹å°±åœ°å¤ç”¨\r\nfunction isSameVnode(oldVnode, newVnode) {\r\n  return oldVnode.tag === newVnode.tag && oldVnode.key === newVnode.key;\r\n}\r\n// diffç®—æ³•æ ¸å¿ƒï¼Œé‡‡ç”¨åŒæŒ‡é’ˆçš„æ–¹å¼ï¼Œå¯¹æ¯”æ–°è€vnodeçš„å„¿å­èŠ‚ç‚¹\r\nfunction updateChildren(parent, oldCh, newCh) {\r\n  let oldStartIndex = 0; //è€å„¿å­çš„èµ·å§‹ä¸‹æ ‡\r\n  let oldStartVnode = oldCh[0]; //è€å„¿å­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹\r\n  let oldEndIndex = oldCh.length - 1; //è€å„¿å­çš„ç»“æŸä¸‹æ ‡\r\n  let oldEndVnode = oldCh[oldEndIndex]; //è€å„¿å­çš„ç»“æŸèŠ‚ç‚¹\r\n\r\n  let newStartIndex = 0; // æ–°å„¿å­çš„ï¼ŒåŒä¸Š\r\n  let newStartVnode = newCh[0];\r\n  let newEndIndex = newCh.length - 1;\r\n  let newEndVnode = newCh[newEndIndex];\r\n\r\n  // æ ¹æ®keyæ¥åˆ›å»ºè€çš„å„¿å­çš„indexæ˜ å°„è¡¨ï¼›ç±»ä¼¼ {'a':0,'b':1}ï¼šè¡¨ç¤ºkeyä¸º'a'çš„èŠ‚ç‚¹åœ¨ç¬¬ä¸€ä¸ªä½ç½®ï¼Œkeyä¸º'b'çš„èŠ‚ç‚¹åœ¨ç¬¬äºŒä¸ªä½ç½®\r\n\r\n  function makeIndexByKey(children) {\r\n    let map = {};\r\n    children.forEach((item, index) => {\r\n      item.key && (map[item.key] = index);\r\n    });\r\n    return map;\r\n  }\r\n  // ç”ŸæˆoldChçš„æ˜ å°„è¡¨ï¼ˆkey:indexï¼‰\r\n  let keysMap = makeIndexByKey(oldCh);\r\n\r\n  // åªæœ‰å½“æ–°è€å„¿å­çš„åŒæŒ‡æ ‡çš„èµ·å§‹ä½ç½®ä¸å¤§äºç»“æŸä½ç½®çš„æ—¶å€™ï¼Œæ‰èƒ½å¾ªç¯ï¼›\r\n  // ä¸€æ–¹çš„å¼€å§‹ä½ç½®å¤§äºç»“æŸä½ç½®ï¼Œè¯´æ˜è¯¥æ–¹å¾ªç¯å®Œæ¯•ï¼Œéœ€è¦ç»“æŸå¾ªç¯\r\n  while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\r\n    // å¦‚æœèŠ‚ç‚¹å·²ç»è¢«ç§»èµ°äº†ï¼Œç›´æ¥è·³è¿‡\r\n    if (!oldStartVnode) {\r\n      oldStartVnode = oldCh[++oldStartIndex];\r\n    } else if (!oldEndVnode) {\r\n      oldEndVnode = oldCh[--oldEndIndex];\r\n    } else if (isSameVnode(oldStartVnode, newStartVnode)) {\r\n      // å¤´å¤´æ¯”è¾ƒ\r\n      patch(oldStartVnode, newStartVnode); // é€’å½’æ¯”è¾ƒå„¿å­ä»¥åŠä»–ä»¬çš„å­èŠ‚ç‚¹\r\n      // æŒ‡é’ˆå¾€åç§»ä¸€ä½ï¼ŒstartVnodeä¹Ÿç›¸åº”æ”¹å˜\r\n      oldStartVnode = oldCh[++oldStartIndex];\r\n      newStartVnode = newCh[++newStartIndex];\r\n    } else if (isSameVnode(oldEndVnode, newEndVnode)) {\r\n      // å°¾å°¾æ¯”è¾ƒ\r\n      patch(oldEndVnode, newEndVnode); // é€’å½’æ¯”è¾ƒå„¿å­ä»¥åŠä»–ä»¬çš„å­èŠ‚ç‚¹\r\n      // æŒ‡é’ˆå¾€å‰ç§»ä¸€ä½ï¼ŒendVnodeä¹Ÿç›¸åº”æ”¹å˜\r\n      oldEndVnode = oldCh[--oldEndIndex];\r\n      newEndVnode = newCh[--newEndIndex];\r\n    } else if (isSameVnode(oldStartVnode, newEndVnode)) {\r\n      // å¤´å°¾æ¯”è¾ƒ\r\n      patch(oldStartVnode, newEndVnode);\r\n      //  æ¯”è¾ƒå®Œï¼Œå°±éœ€è¦å°†é€’å½’çš„ç»“æœï¼Œæ”¾åˆ°oldEndVnodeåé¢ï¼ˆå› ä¸ºæ–°çš„æ˜¯åœ¨å°¾éƒ¨ï¼Œæ‰€ä»¥å½“å¤´å°¾æ¯”è¾ƒæ»¡è¶³samavnodeæ—¶ï¼Œéœ€è¦å°†è€çš„vnodeç§»åˆ°å°¾éƒ¨ï¼Œä¸newChé¡ºåºä¿æŒä¸€è‡´ï¼‰\r\n      parent.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling); // æ¯”è¾ƒå®Œï¼Œå°±éœ€è¦å°†ç»“æœç§»åŠ¨åˆ°æœ«å°¾\r\n      // æŒ‡é’ˆæ”¹å˜ï¼ŒoldStartVnodeã€newEndVnodeç›¸åº”æ”¹å˜\r\n      oldStartVnode = oldCh[++oldStartIndex];\r\n      newEndVnode = newCh[--newEndIndex];\r\n    } else if (isSameVnode(oldEndVnode, newStartVnode)) {\r\n      // å°¾å¤´æ¯”è¾ƒ\r\n      patch(oldEndVnode, newStartVnode);\r\n      //  æ¯”è¾ƒå®Œï¼Œå°±éœ€è¦å°†é€’å½’çš„ç»“æœï¼Œæ”¾åˆ°oldStartVnodeå‰é¢ï¼ˆå› ä¸ºæ–°çš„æ˜¯åœ¨å¤´éƒ¨ï¼Œæ‰€ä»¥å½“å°¾å¤´æ¯”è¾ƒæ»¡è¶³samavnodeæ—¶ï¼Œéœ€è¦å°†è€çš„vnodeç§»åˆ°å¤´éƒ¨ï¼Œä¸newChé¡ºåºä¿æŒä¸€è‡´ï¼‰\r\n      parent.insertBefore(oldEndVnode.el, oldStartVnode.el);\r\n      // æŒ‡é’ˆæ”¹å˜ï¼ŒoldEndVnodeã€newStartVnodeç›¸åº”æ”¹å˜\r\n      oldEndVnode = oldCh[--oldEndIndex];\r\n      newStartVnode = newCh[++newStartIndex];\r\n    } else {\r\n      // å¦‚æœä»¥ä¸Šå››ç§æƒ…å†µéƒ½ä¸æ»¡è¶³ï¼Œéœ€è¦è¿›è¡Œæš´åŠ›å¯¹æ¯”\r\n      // åœ¨oldChä¸­å¯»æ‰¾newStartVnodeå¯¹åº”keyç›¸åŒçš„èŠ‚ç‚¹ï¼ˆkeysMapæ˜¯è¡¨ç¤ºoldChä¸­key-indexå¯¹åº”å…³ç³»çš„å¯¹è±¡ï¼‰\r\n      let moveIndex = keysMap[newStartVnode.key];\r\n      if (!moveIndex) {\r\n        // å¦‚æœè€çš„èŠ‚ç‚¹æ‰¾ä¸åˆ°ä¸newStartVnodeç›¸åŒkeyçš„èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥å°†newStartVnodeæ’å…¥\r\n        parent.insertBefore(createElm(newStartVnode), oldStartVnode.el);\r\n      } else {\r\n        // å¦‚æœåœ¨oldChä¸­æ‰¾åˆ°ä¸newStartVnodeç›¸åŒkeyçš„èŠ‚ç‚¹\r\n        let moveVnode = oldCh[moveIndex]; // æ‰¾å¾—åˆ°å°±æ‹¿åˆ°è€çš„èŠ‚ç‚¹\r\n        oldCh[moveIndex] = null; //  è¿™ä¸ªæ˜¯å ä½æ“ä½œï¼Œé¿å…æ•°ç»„å¡Œé™·ï¼Œé˜²æ­¢è€èŠ‚ç‚¹ç§»åŠ¨èµ°äº†ä¹‹åç ´åäº†åˆå§‹çš„æ˜ å°„è¡¨ä½ç½®ï¼Œå³åç»­å¦‚æœå†æ¬¡é‡‡ç”¨ä¹±åºæ¯”å¯¹ä¼šå‡ºç°ç´¢å¼•ä½ç½®é”™ä¹±ï¼ˆå› ä¸ºmoveVnodeæ˜¯æ ¹æ®ç´¢å¼•è·å–çš„ï¼‰\r\n        parent.insertBefore(moveVnode.el, oldStartVnode.el); //æŠŠæ‰¾åˆ°çš„èŠ‚ç‚¹ç§»åŠ¨åˆ°æœ€å‰é¢\r\n        patch(moveVnode, newStartVnode); //  é€’å½’patch\r\n      }\r\n      // æŒ‡é’ˆå’ŒnewStartVnodeç›¸åº”åšå‡ºæ”¹å˜\r\n      newStartVnode = newCh[++newStartIndex];\r\n    }\r\n  }\r\n\r\n  // å¦‚æœè€èŠ‚ç‚¹å¾ªç¯å®Œæ¯•äº†ï¼Œä½†æ˜¯æ–°èŠ‚ç‚¹è¿˜æœ‰ï¼›è¯æ˜æ–°èŠ‚ç‚¹éœ€è¦è¢«æ·»åŠ åˆ°å¤´éƒ¨æˆ–è€…å°¾éƒ¨\r\n  if (newStartIndex <= newEndIndex) {\r\n    // æ­¤æ—¶newStartIndexå¹¶éä¸º0ï¼Œè€Œæ˜¯ç­‰äºoldChæ¯”å¯¹å®Œæ—¶ï¼ŒnewChæ‰€å¤„çš„ä½ç½®\r\n    // éå†newChå‰©ä½™çš„èŠ‚ç‚¹ï¼Œç”ŸæˆçœŸå®domï¼Œæ’å…¥åˆ°parentä¸­\r\n    for (let i = newStartIndex; i <= newEndIndex; i++) {\r\n      // çœ‹ä¸‹ä¸€ä¸ªæŒ‡é’ˆæ˜¯å¦ä¸ºnullï¼Œä¸æ˜¯çš„è¯ï¼Œå–å®ƒçš„elå±æ€§\r\n      // è¿™æ˜¯ä¸€ä¸ªä¼˜åŒ–å†™æ³• insertBeforeçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯nullç­‰åŒäºappendChildä½œç”¨\r\n      const anchor =\r\n        newCh[newEndIndex + 1] == null ? null : newCh[newEndIndex + 1].el;\r\n      parent.insertBefore(createElm(newCh[i]), anchor);\r\n    }\r\n  }\r\n\r\n  // å¦‚æœæ–°èŠ‚ç‚¹å¾ªç¯å®Œæ¯•ï¼Œè€èŠ‚ç‚¹è¿˜æœ‰ï¼›è¯æ˜è€çš„èŠ‚ç‚¹éœ€è¦ç›´æ¥è¢«åˆ é™¤\r\n  if (oldStartIndex <= oldEndIndex) {\r\n    // éå†oldChå‰©ä½™çš„èŠ‚ç‚¹ï¼Œå°†ä»–ä»¬ä»parentä¸­åˆ é™¤\r\n    for (let i = oldStartIndex; i <= oldEndIndex; i++) {\r\n      let child = oldCh[i];\r\n      if (!child) {\r\n        parent.removeChild(child.el);\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { patch } from \"./vdom/patch\";\r\nimport Watcher from \"./observer/watcher\";\r\n\r\nexport function lifecycleMixin(Vue) {\r\n  // _updateï¼šåˆå§‹æŒ‚è½½åŠåç»­æ›´æ–°\r\n  // æ›´æ–°çš„æ—¶å€™ï¼Œä¸ä¼šé‡æ–°è¿›è¡Œæ¨¡æ¿ç¼–è¯‘ï¼Œå› ä¸ºæ›´æ–°åªæ˜¯æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œrenderå‡½æ•°æ²¡æœ‰æ”¹å˜ã€‚\r\n  Vue.prototype._update = function (vnode) {\r\n    const vm = this;\r\n    const prevVnode = vm._vnode; // è·å–ä¸Šä¸€æ¬¡çš„vnode\r\n    vm._vnode = vnode; // ä¿å­˜æœ¬æ¬¡çš„vnode\r\n\r\n    // ã€æ ¸å¿ƒã€‘patchæ˜¯æ¸²æŸ“vnodeä¸ºçœŸå®dom\r\n    if (!prevVnode) {\r\n      // åˆæ¬¡æ¸²æŸ“\r\n      vm.$el = patch(vm.$el, vnode); // åˆæ¬¡æ¸²æŸ“ vm._vnodeè‚¯å®šä¸å­˜åœ¨ è¦é€šè¿‡è™šæ‹ŸèŠ‚ç‚¹ æ¸²æŸ“å‡ºçœŸå®çš„dom èµ‹å€¼ç»™$elå±æ€§\r\n    } else {\r\n      // è§†å›¾æ›´æ–°\r\n      vm.$el = patch(prevVnode, vnode); // æ›´æ–°æ—¶æŠŠä¸Šæ¬¡çš„vnodeå’Œè¿™æ¬¡æ›´æ–°çš„vnodeç©¿è¿›å» è¿›è¡Œdiffç®—æ³•\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * 1. è°ƒç”¨renderæ–¹æ³•ï¼Œç”Ÿæˆè™šæ‹ŸDOM â€”â€” å³æ‰§è¡Œ vm._render()\r\n * 2. å°†VNodeæ¸²æŸ“æˆçœŸå®DOM â€”â€” å³æ‰§è¡Œ vm._update(VNode)\r\n */\r\nexport function mountComponent(vm, el) {\r\n  // å®šä¹‰vm.$elï¼Œå¦‚æœæ—¶ç»„ä»¶ï¼Œoptionsä¸Šæ²¡æœ‰elå±æ€§ï¼Œvm.$elä¸ºundefined\r\n  vm.$el = el;\r\n  // æ‰§è¡ŒbeforeMountç”Ÿå‘½å‘¨æœŸé’©å­\r\n  callHook(vm, \"beforeMount\");\r\n\r\n  let updateComponent = () => {\r\n    vm._update(vm._render());\r\n  };\r\n\r\n  // æ¯ä¸ªç»„ä»¶æ¸²æŸ“çš„æ—¶å€™ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªwatcherï¼Œå¹¶æ‰§è¡ŒupdateComponentï¼›trueè¡¨ç¤ºæ˜¯æ¸²æŸ“Watcher\r\n  new Watcher(\r\n    vm,\r\n    updateComponent,\r\n    () => {\r\n      console.log('è§†å›¾æ›´æ–°äº†')\r\n      callHook(vm, \"beforeUpdate\");\r\n    },\r\n    true\r\n  );\r\n  callHook(vm, \"mounted\");\r\n}\r\n\r\nexport function callHook(vm, hook) {\r\n  // vm.$options[hook]ç»è¿‡mergeOptionsåˆå¹¶ä¹‹åï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„\r\n  const handlers = vm.$options[hook];\r\n  if (handlers) {\r\n    for (let i = 0; i < handlers.length; i++) {\r\n      handlers[i].call(vm); //ç”Ÿå‘½å‘¨æœŸé‡Œé¢çš„thisæŒ‡å‘å½“å‰å®ä¾‹\r\n    }\r\n  }\r\n}\r\n","/**\r\n * initMixin\r\n * è¡¨ç¤ºåœ¨vueçš„åŸºç¡€ä¸Šåšä¸€æ¬¡æ··åˆæ“ä½œ\r\n */\r\nimport { initState } from \"./state\";\r\nimport { compileToFunctions } from './compiler/index'\r\nimport { callHook, mountComponent } from './lifecycle'\r\nimport { mergeOptions } from \"./util/index\";\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    // thisæŒ‡å‘å®ä¾‹\r\n    const vm = this;\r\n    // å°†å…¨å±€çš„Vue.optionsï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯ç»§æ‰¿çš„å…¶ä»–ç»„ä»¶çš„optionsï¼Œæ‰€ä»¥ä¸‹é¢ä½¿ç”¨çš„æ˜¯vm.constructor.optionsè€Œä¸æ˜¯Vue.optionsï¼‰ä¸ç»„ä»¶ä¸­çš„optionsè¿›è¡Œåˆå¹¶\r\n    // å°†åˆå¹¶ä¹‹åçš„ç»“æœæ”¾åˆ°vm.$optionsä¸Š\r\n    vm.$options = mergeOptions(vm.constructor.options, options);\r\n    console.log('$options-----',vm.$options)\r\n    callHook(vm, \"beforeCreate\");\r\n    \r\n    // åˆå§‹åŒ–çŠ¶æ€ï¼ŒåŒ…æ‹¬initPropsã€initMethodã€initDataã€initComputedã€initWatchç­‰\r\n    initState(vm);\r\n\r\n    callHook(vm, \"created\");\r\n    // å¦‚æœæœ‰elå±æ€§ è¿›è¡Œæ¨¡æ¿æ¸²æŸ“\r\n    if (vm.$options.el) {\r\n      vm.$mount(vm.$options.el);\r\n    }\r\n  };\r\n\r\n  Vue.prototype.$mount = function (el) {\r\n    // $mount ç”±vueå®ä¾‹è°ƒç”¨ï¼Œæ‰€ä»¥thisæŒ‡å‘vueå®ä¾‹\r\n    const vm = this;\r\n    const options = vm.$options;\r\n    el = document.querySelector(el);\r\n\r\n    /**\r\n     * 1. æŠŠæ¨¡æ¿è½¬åŒ–æˆrenderå‡½æ•°\r\n     * 2. æ‰§è¡Œrenderå‡½æ•°ï¼Œç”ŸæˆVNode\r\n     * 3. æ›´æ–°æ—¶è¿›è¡Œdiff\r\n     * 4. äº§ç”ŸçœŸå®DOM\r\n     */\r\n    // å¯ä»¥ç›´æ¥åœ¨optionsä¸­å†™renderå‡½æ•°ï¼Œå®ƒçš„ä¼˜å…ˆçº§æ¯”templateé«˜\r\n    if (!options.render) {\r\n      let template = options.template;\r\n\r\n      // å¦‚æœä¸å­˜åœ¨renderå’Œtemplateä½†æ˜¯å­˜åœ¨elå±æ€§ï¼Œåˆ™ç›´æ¥å°†templateèµ‹å€¼ä¸ºelå…ƒç´ \r\n      if (!template && el) {\r\n        template = el.outerHTML;\r\n      }\r\n\r\n      // æœ€ç»ˆéœ€è¦æŠŠtempalteæ¨¡æ¿è½¬åŒ–æˆrenderå‡½æ•°\r\n      if (template) {\r\n        // å°†templateè½¬åŒ–æˆrenderå‡½æ•°\r\n        const render = compileToFunctions(template);\r\n        options.render = render;\r\n      }\r\n    }\r\n\r\n    // è°ƒç”¨renderæ–¹æ³•ï¼Œæ¸²æŸ“æˆçœŸå®DOM\r\n    // ç»„ä»¶æŒ‚è½½æ–¹æ³•\r\n    return mountComponent(vm, el);\r\n  };\r\n}\r\n","import { isReservedTag, isObject } from \"../util/index\";\r\n\r\nexport default class Vnode {\r\n  /**\r\n   * @param {æ ‡ç­¾å} tag\r\n   * @param {å±æ€§} data\r\n   * @param {æ ‡ç­¾å”¯ä¸€çš„key} key\r\n   * @param {å­èŠ‚ç‚¹} children\r\n   * @param {æ–‡æœ¬èŠ‚ç‚¹} text\r\n   * @param {ç»„ä»¶èŠ‚ç‚¹çš„å…¶ä»–å±æ€§} componentOptions\r\n   */\r\n  constructor(tag, data, key, children, text, componentOptions) {\r\n    this.tag = tag;\r\n    this.data = data;\r\n    this.key = key;\r\n    this.children = children;\r\n    this.text = text;\r\n    this.componentOptions = componentOptions;\r\n  }\r\n}\r\n\r\n// åˆ›å»ºå…ƒç´ vnode\r\nexport function createElement(vm, tag, data = {}, ...children) {\r\n  let key = data.key;\r\n  // å¦‚æœæ˜¯æ™®é€šæ ‡ç­¾\r\n  if (isReservedTag(tag)) {\r\n    return new Vnode(tag, data, key, children);\r\n  } else {\r\n    // å¦åˆ™å°±æ˜¯ç»„ä»¶\r\n    let Ctor = vm.$options.components[tag]; // è·å–ç»„ä»¶çš„æ„é€ å‡½æ•°\r\n    return createComponent(vm, tag, data, key, children, Ctor);\r\n  }\r\n}\r\n\r\n// ç»„ä»¶å¤„ç†\r\nfunction createComponent(vm, tag, data, key, children, Ctor) {\r\n  // Ctorå¦‚æœæ˜¯å±€éƒ¨ç»„ä»¶ï¼Œåˆ™ä¸ºä¸€ä¸ªå¯¹è±¡ï¼›å¦‚æœæ˜¯å…¨å±€ç»„ä»¶ï¼ˆVue.componentåˆ›å»ºçš„ï¼‰ï¼Œåˆ™ä¸ºä¸€ä¸ªæ„é€ å‡½æ•°\r\n  if (isObject(Ctor)) {\r\n    Ctor = vm.$options._base.extend(Ctor);\r\n  }\r\n\r\n  // å®šä¹‰ç»„ä»¶è‡ªå·±å†…éƒ¨çš„ç”Ÿå‘½å‘¨æœŸï¼›\r\n  // ã€å…³é”®ã€‘ç­‰ä¼šæ¸²æŸ“ç»„ä»¶æ—¶ï¼Œéœ€è¦è°ƒç”¨æ­¤åˆå§‹åŒ–æ–¹æ³•\r\n  data.hook = {\r\n    // ç»„ä»¶åˆ›å»ºè¿‡ç¨‹çš„è‡ªèº«åˆå§‹åŒ–æ–¹æ³•\r\n    init(vnode) {\r\n      // new Ctor()ç›¸å½“äºæ‰§è¡ŒVue.extend()ï¼Œå³ç›¸å½“äºnew Subï¼›åˆ™ç»„ä»¶ä¼šå°†è‡ªå·±çš„é…ç½®ä¸{ _isComponent: true }åˆå¹¶\r\n      let child = (vnode.componentInstance = new Ctor({ _isComponent: true })); // å®ä¾‹åŒ–ç»„ä»¶\r\n      // å› ä¸ºæ²¡æœ‰ä¼ å…¥elå±æ€§ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‚è½½ï¼Œä¸ºäº†åœ¨ç»„ä»¶å®ä¾‹ä¸Šé¢å¢åŠ $elæ–¹æ³•å¯ç”¨äºç”Ÿæˆç»„ä»¶çš„çœŸå®æ¸²æŸ“èŠ‚ç‚¹\r\n      child.$mount(); // ç»„ä»¶æŒ‚è½½åä¼šåœ¨vmä¸Šæ·»åŠ vm.$el çœŸå®domèŠ‚ç‚¹\r\n    },\r\n  };\r\n\r\n  // ç»„ä»¶vnodeä¹Ÿå«å ä½ç¬¦vnode  ==> $vnode\r\n  return new Vnode(\r\n    `vue-component-${tag}`,\r\n    data,\r\n    key,\r\n    undefined,\r\n    undefined,\r\n    {\r\n      Ctor,\r\n      children,\r\n    }\r\n  );\r\n}\r\n\r\n// åˆ›å»ºæ–‡æœ¬vnode\r\nexport function createTextNode(vm, text) {\r\n  return new Vnode(undefined, undefined, undefined, undefined, text);\r\n}\r\n","import { createElement, createTextNode } from \"./vdom/index\";\r\nimport { nextTick } from \"./util/next-tick\";\r\n\r\nexport function renderMixin(Vue) {\r\n  Vue.prototype._c = function (...args) {\r\n    // åˆ›å»ºè™šæ‹Ÿdomå…ƒç´ \r\n    return createElement(this,...args);\r\n  };\r\n  Vue.prototype._v = function (text) {\r\n    // åˆ›å»ºè™šæ‹Ÿdomæ–‡æœ¬\r\n    return createTextNode(this,text);\r\n  };\r\n  Vue.prototype._s = function (val) {\r\n    // å¦‚æœæ¨¡æ¿é‡Œé¢çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œéœ€è¦JSON.stringify\r\n    return val == null\r\n      ? \"\"\r\n      : typeof val === \"object\"\r\n      ? JSON.stringify(val)\r\n      : val;\r\n  };\r\n\r\n  Vue.prototype._render = function () {\r\n    const vm = this;\r\n    // è·å–æ¨¡æ¿ç¼–è¯‘ç”Ÿæˆçš„renderæ–¹æ³•\r\n    const { render } = vm.$options;\r\n    \r\n    // ç”Ÿæˆvnode--è™šæ‹Ÿdom\r\n    const vnode = render.call(vm);\r\n    console.log(\"ğŸš€vnode-----\", vnode);\r\n    return vnode;\r\n  };\r\n\r\n  // æŒ‚è½½åœ¨åŸå‹çš„nextTickæ–¹æ³•\r\n  Vue.prototype.$nextTick = nextTick;\r\n}\r\n","import { mergeOptions } from '../util/index'\r\n\r\nexport default function initMixin(Vue) {\r\n    Vue.mixin = function(mixin) {\r\n        // this æŒ‡å‘ VUeï¼Œthis.optionså³Vue.options\r\n        // å°†mixinåˆå¹¶åˆ°Vue.optionsä¸­ï¼Œè€Œç»„ä»¶ä¼šå’ŒVue.optionsåˆå¹¶ï¼Œæ‰€ä»¥æœ€åä¼šæŠŠmixinåˆå¹¶åˆ°ç»„ä»¶ä¸­\r\n        this.options = mergeOptions(this.options,mixin)\r\n        return this;\r\n    }\r\n}","import { mergeOptions } from \"../util/index\";\r\n\r\nexport default function initExtend(Vue) {\r\n  let cid = 0;\r\n\r\n  // Vue.extend(extendOptions)åšçš„äº‹æƒ…å°±æ˜¯ï¼šåˆ›å»ºå­ç±»ï¼Œç»§æ‰¿Vueçˆ¶ç±»ï¼›å¹¶ä¸”èº«ä¸Šæœ‰çˆ¶ç±»çš„æ‰€æœ‰åŠŸèƒ½\r\n  Vue.extend = function (extendOptions) {\r\n    // åˆ›å»ºå­ç±»çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•\r\n    const Sub = function VueComponent(options) {\r\n      this._init(options); // thisæŒ‡å‘å­ç±»çš„å®ä¾‹\r\n    };\r\n    Sub.cid = cid++; // ç»„ä»¶çš„å”¯ä¸€æ ‡è¯†\r\n\r\n    // ä½¿ç”¨åŸå‹ç»§æ‰¿ï¼Œå°†å­ç±»ç»§æ‰¿çˆ¶ç±»\r\n    Sub.prototype = Object.create(this.prototype); // å­ç±»åŸå‹æŒ‡å‘çˆ¶ç±»\r\n    Sub.prototype.constructor = Sub; // constructoræŒ‡å‘è‡ªå·±\r\n\r\n    Sub.options = mergeOptions(this.options, extendOptions); // åˆå¹¶è‡ªå·±çš„extendOptionså’Œçˆ¶ç±»çš„optionsï¼ˆå³Vue.optionsï¼‰\r\n    return Sub;\r\n  };\r\n}\r\n","import { ASSETS_TYPE } from \"./const\";\r\nexport default function initAssetRegisters(Vue) {\r\n  ASSETS_TYPE.forEach((type) => {\r\n    Vue[type] = function (id, definition) {\r\n      if (type === \"component\") {\r\n        // Vue.component(id,definition)å°±æ˜¯è°ƒç”¨ Vue.extend(definition)ï¼Œå¹¶é…ç½®Vue.options.components.id = definition\r\n        definition = this.options._base.extend(definition);\r\n      } else if (type === \"filter\") {\r\n        // ...\r\n      } else if (type === \"directive\") {\r\n        // ...\r\n      }\r\n\r\n      // é…ç½®Vue.options[components/filters/directive]\r\n      this.options[type + \"s\"][id] = definition;\r\n    };\r\n  });\r\n}\r\n","import initMixin from \"./mixin\";\r\nimport initExtend from \"./extend\";\r\nimport { ASSETS_TYPE } from \"./const\";\r\nimport initAssetRegisters from \"./assets\";\r\n\r\nexport function initGlobalApi(Vue) {\r\n  // æ¯ä¸ªç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™éƒ½ä¼šå’ŒVue.optionsé€‰é¡¹è¿›è¡Œåˆå¹¶\r\n  Vue.options = {}; // ç”¨æ¥å­˜æ”¾å…¨å±€å±æ€§ï¼Œä¾‹å¦‚Vue.componentã€Vue.filterã€Vue.directive\r\n  initMixin(Vue);\r\n\r\n  // åˆå§‹åŒ–Vue.options.componentsã€Vue.options.directivesã€Vue.options.filtersè®¾ä¸ºç©ºå¯¹è±¡\r\n  ASSETS_TYPE.forEach((type) => {\r\n    Vue.options[type + \"s\"] = {};\r\n  });\r\n\r\n  // Vue.optionsä¼šä¸ç»„ä»¶çš„optionsåˆå¹¶ï¼Œæ‰€ä»¥æ— è®ºåˆ›å»ºå¤šå°‘å­ç±»ï¼Œéƒ½å¯ä»¥é€šè¿‡å®ä¾‹çš„options._baseæ‰¾åˆ°Vue\r\n  Vue.options._base = Vue;\r\n  initExtend(Vue); // æ³¨å†Œextendæ–¹æ³•\r\n\r\n  initAssetRegisters(Vue); // æ³¨å†ŒVue.component()ã€Vue.filter()ã€Vue.directive()æ–¹æ³•\r\n}\r\n","import { initMixin } from \"./init\";\r\nimport { lifecycleMixin } from \"./lifecycle\";\r\nimport { renderMixin } from \"./render\";\r\nimport { initGlobalApi } from \"./global-api/index\";\r\nimport { stateMixin } from \"./state\";\r\n\r\nfunction Vue(options) {\r\n  // new Vueåˆ›å»ºå®ä¾‹æ—¶ä¼šè°ƒç”¨_init()æ–¹æ³•\r\n  this._init(options);\r\n}\r\ninitMixin(Vue); // åœ¨åŸå‹ä¸ŠæŒ‚è½½_init()ï¼ˆæ•°æ®ç›‘æ§ï¼›propsã€eventsã€computedã€watchåˆå§‹åŒ–ç­‰ï¼‰ã€$mount()ï¼ˆcompileræµç¨‹ï¼‰æ–¹æ³•\r\nlifecycleMixin(Vue); // åœ¨åŸå‹ä¸ŠæŒ‚è½½ _update()æ–¹æ³•ï¼ˆç¬¬ä¸€æ¬¡åˆ›å»ºdomåŠæ›´æ–°domï¼ˆæœ‰diffè¿‡ç¨‹ï¼‰ï¼‰\r\nrenderMixin(Vue); //  åœ¨åŸå‹ä¸ŠæŒ‚è½½_cã€_vã€_sã€$nextTickã€_render()æ–¹æ³•\r\nstateMixin(Vue);  // initDataã€initComputedã€initWatchç­‰\r\ninitGlobalApi(Vue); // initMixinï¼ˆVue.mixin(options)ï¼‰\r\n\r\nexport default Vue;\r\n"],"names":["ASSETS_TYPE","LIFECYCLE_HOOKS","strats","mergeHook","parentVal","childVal","concat","forEach","hook","mergeAssets","res","Object","create","k","type","mergeOptions","parent","child","options","mergeFiled","hasOwnProperty","key","isObject","val","isFunction","isReservedTag","tagName","str","obj","split","tag","oldArrayPrototype","Array","prototype","arrayMethods","methods","method","args","result","call","ob","__ob__","inserted","slice","observeArray","dep","notify","id","Dep","subs","target","addDep","watcher","update","push","targetStack","pushTarget","popTarget","pop","length","Observer","data","value","defineProperty","enumerable","writable","configurable","isArray","__proto__","walk","item","observe","keys","defineReactive","childOb","get","depend","dependArray","set","newVal","console","log","e","i","l","callbacks","flushCallbacks","cb","waiting","nextTick","Promise","resolve","then","queue","has","queueWatcher","flushSchedulerQueue","index","run","Watcher","vm","exprOrFn","user","lazy","dirty","deps","depsId","Set","getter","path","undefined","add","addSub","oldVal","initState","opts","$options","props","initData","computed","initComputed","watch","initWatch","_data","proxy","watchers","_computedWatchers","userDef","defineComputed","sharedPropertyDefinition","createComputedGetter","evaluate","handler","handle","createWatcher","$watch","source","newValue","stateMixin","Vue","immediate","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","attribute","parse","template","root","currentParent","stack","ELEMENT_TYPE","TEXT_TYPE","createASTElement","attrs","children","handleStartTag","element","handleEndTag","handleChars","text","replace","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","start","end","attr","name","n","defaultTagRE","gen","node","generate","test","JSON","stringify","lastIndex","tokens","exec","trim","join","getChildren","el","map","c","genProps","ast","code","compileToFunctions","renderFn","Function","patch","oldVnode","vnode","createElm","isRealElement","nodeType","oldElm","parentElm","parentNode","insertBefore","nextSibling","removeChild","replaceChild","textContent","updateProperties","oldCh","newCh","updateChildren","innerHTML","appendChild","createComponent","componentInstance","$el","document","createElement","createTextNode","init","oldProps","newProps","removeAttribute","newStyle","style","oldStyle","styleName","className","setAttribute","isSameVnode","newVnode","oldStartIndex","oldStartVnode","oldEndIndex","oldEndVnode","newStartIndex","newStartVnode","newEndIndex","newEndVnode","makeIndexByKey","keysMap","moveIndex","moveVnode","anchor","lifecycleMixin","_update","prevVnode","_vnode","mountComponent","callHook","updateComponent","_render","handlers","initMixin","_init","constructor","$mount","querySelector","render","outerHTML","Vnode","componentOptions","Ctor","components","_base","extend","_isComponent","renderMixin","_c","_v","_s","$nextTick","mixin","initExtend","cid","extendOptions","Sub","VueComponent","initAssetRegisters","definition","initGlobalApi"],"mappings":"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"}